[{"path":[]},{"path":"https://best-practice-and-impact.github.io/aftables/CODE_OF_CONDUCT.html","id":"civil-service-code","dir":"","previous_headings":"","what":"Civil Service Code","title":"Code of Conduct for aftables","text":"Contributors working within Majesty’s Government must review Civil Service Code, expected follow contributions.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/CODE_OF_CONDUCT.html","id":"our-pledge","dir":"","previous_headings":"","what":"Our Pledge","title":"Code of Conduct for aftables","text":"members, contributors, leaders pledge make participation community harassment-free experience everyone, regardless age, body size, visible invisible disability, ethnicity, sex characteristics, gender identity expression, level experience, education, socio-economic status, nationality, personal appearance, race, caste, colour, religion, sexual identity orientation. pledge act interact ways contribute open, welcoming, diverse, inclusive, healthy community.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/CODE_OF_CONDUCT.html","id":"our-standards","dir":"","previous_headings":"","what":"Our Standards","title":"Code of Conduct for aftables","text":"aftables cross-government collaboration. encourage contributors act accordance highest standards professional conduct, adhere Civil Service Code. expect contributors avoid engaging political activity discussion forums relating project. Examples behaviour contributes positive environment community include: - Demonstrating empathy kindness toward people - respectful differing opinions, viewpoints, experiences - Giving gracefully accepting constructive feedback - Accepting responsibility apologizing affected mistakes, learning experience - Focusing best just us individuals, overall community Examples unacceptable behaviour include: - use sexualized language imagery, sexual attention advances kind - Trolling, insulting derogatory comments, personal political attacks - Harassment nature - Publishing others’ private information, physical email address, without explicit permission - conduct reasonably considered inappropriate professional setting","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/CODE_OF_CONDUCT.html","id":"enforcement","dir":"","previous_headings":"","what":"Enforcement","title":"Code of Conduct for aftables","text":"Instances abusive, harassing, otherwise unacceptable behaviour may reported community leaders responsible enforcement ASAP@ons.gov.uk. complaints reviewed investigated promptly fairly. community leaders obligated respect privacy security reporter incident.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/CODE_OF_CONDUCT.html","id":"enforcement-responsibilities","dir":"","previous_headings":"Enforcement","what":"Enforcement Responsibilities","title":"Code of Conduct for aftables","text":"Community leaders responsible clarifying enforcing standards acceptable behaviour take appropriate action response behaviour deem inappropriate, threatening, offensive, harmful. Community leaders right responsibility remove, edit, reject comments, commits, code, issues, contributions aligned Code Conduct, communicate reasons moderation decisions appropriate.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/CODE_OF_CONDUCT.html","id":"enforcement-guidelines","dir":"","previous_headings":"Enforcement","what":"Enforcement Guidelines","title":"Code of Conduct for aftables","text":"Community leaders follow Community Impact Guidelines determining consequences action deem violation Code Conduct:","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/CODE_OF_CONDUCT.html","id":"id_1-correction","dir":"","previous_headings":"Enforcement > Enforcement Guidelines","what":"1. Correction","title":"Code of Conduct for aftables","text":"Community Impact: Use inappropriate language behaviour deemed unprofessional unwelcome community. Consequence: private, written warning community leaders, providing clarity around nature violation explanation behaviour inappropriate. public apology may requested.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/CODE_OF_CONDUCT.html","id":"id_2-warning","dir":"","previous_headings":"Enforcement > Enforcement Guidelines","what":"2. Warning","title":"Code of Conduct for aftables","text":"Community Impact: violation single incident series actions. Consequence: warning consequences continued behaviour. interaction people involved, including unsolicited interaction enforcing Code Conduct, specified period time. includes avoiding interactions community spaces well external channels like social media. Violating terms may lead temporary permanent ban.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/CODE_OF_CONDUCT.html","id":"id_3-temporary-ban","dir":"","previous_headings":"Enforcement > Enforcement Guidelines","what":"3. Temporary Ban","title":"Code of Conduct for aftables","text":"Community Impact: serious violation community standards, including sustained inappropriate behaviour. Consequence: temporary ban sort interaction public communication community specified period time. public private interaction people involved, including unsolicited interaction enforcing Code Conduct, allowed period. Violating terms may lead permanent ban.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/CODE_OF_CONDUCT.html","id":"id_4-permanent-ban","dir":"","previous_headings":"Enforcement > Enforcement Guidelines","what":"4. Permanent Ban","title":"Code of Conduct for aftables","text":"Community Impact: Demonstrating pattern violation community standards, including sustained inappropriate behaviour, harassment individual, aggression toward disparagement classes individuals. Consequence: permanent ban sort public interaction within community.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/CODE_OF_CONDUCT.html","id":"scope","dir":"","previous_headings":"","what":"Scope","title":"Code of Conduct for aftables","text":"Code Conduct applies within community spaces, also applies individual officially representing community public spaces. Examples representing community include using official e-mail address, posting via official social media account, acting appointed representative online offline event.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/CODE_OF_CONDUCT.html","id":"attribution","dir":"","previous_headings":"","what":"Attribution","title":"Code of Conduct for aftables","text":"Code Conduct adapted Contributor Covenant v2.1, Duck Book Code Conduct. Community Impact Guidelines inspired Mozilla’s code conduct enforcement ladder. answers common questions code conduct, see FAQs associated translations.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/CONTRIBUTING.html","id":null,"dir":"","previous_headings":"","what":"Contributing to {aftables}","title":"Contributing to {aftables}","text":"outlines propose change {aftables}.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/CONTRIBUTING.html","id":"fixing-typos","dir":"","previous_headings":"","what":"Fixing typos","title":"Contributing to {aftables}","text":"can fix typos, spelling mistakes, grammatical errors documentation directly using GitHub web interface, long changes made source file. generally means ’ll need edit roxygen2 comments .R, .Rd file. can find .R file generates .Rd reading comment first line.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/CONTRIBUTING.html","id":"bigger-changes","dir":"","previous_headings":"","what":"Bigger changes","title":"Contributing to {aftables}","text":"want make bigger change, ’s good idea first file issue make sure package maintainers agree ’s needed. ’ve found bug, please file issue illustrates bug minimal reprex.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/CONTRIBUTING.html","id":"pull-request-process","dir":"","previous_headings":"Bigger changes","what":"Pull request process","title":"Contributing to {aftables}","text":"work Government Analysis Function, request write access repository contacting package maintainers. external, fork repository. Clone repository onto computer crate Git branch changes. Make changes, commit git, create PR. title PR briefly describe change. body PR contain Fixes #issue-number. means issue automatically close PR merged. Add package maintainers PR reviewers. user-facing changes, add bullet top NEWS.md (.e. just first header). Add ‘Authors’ section DESCRIPTION file. rule thumb, please assign role author (\"aut\") writing exported function, contributor (\"ctb\") anything else.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/CONTRIBUTING.html","id":"code-style","dir":"","previous_headings":"Bigger changes","what":"Code style","title":"Contributing to {aftables}","text":"New code follow tidyverse style guide. can use styler package apply styles, please don’t restyle code nothing PR. use roxygen2, Markdown syntax, documentation. use testthat unit tests. Contributions test cases included easier accept.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2023 Crown Copyright Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/articles/aftables.html","id":"purpose","dir":"Articles","previous_headings":"","what":"Purpose","title":"Introduction to {aftables}","text":"vignette demonstrates use {aftables} generate spreadsheet output automatically follows best practice.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/articles/aftables.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"Introduction to {aftables}","text":"Install package GitHub using {remotes}. package depends {openxlsx} {pillar}, also installed {aftables}.","code":"install.packages(\"remotes\")  # if not already installed remotes::install_github(\"best-practice-and-impact/aftables\")"},{"path":"https://best-practice-and-impact.github.io/aftables/articles/aftables.html","id":"workflow","dir":"Articles","previous_headings":"","what":"Workflow","title":"Introduction to {aftables}","text":"installed {aftables} package, three steps generating compliant spreadsheet: Use create_aftable() create special dataframe (class ‘aftable’) contains content go spreadsheet Pass output generate_workbook() convert aftable {openxlsx}‘s ’Workbook’ class, adds spreadsheet structure styles Pass output openxlsx::saveWorkbook() write xlsx file (openxlsx::openXL() open temporary copy) can use package’s RStudio Addin, installed {aftables}, insert pre-filled demo skeleton workflow (RStudio users ).","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/articles/aftables.html","id":"create-an-aftable","dir":"Articles","previous_headings":"Workflow","what":"1. Create an aftable","title":"Introduction to {aftables}","text":"argument create_aftable() provides information needed construct sheet spreadsheet. can read arguments requirements function’s help pages, can access running ?create_aftable R console. See also terminology vignette, vignette(\"terminology\", \"aftables\"), terms .","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/articles/aftables.html","id":"pre-prepare-tables","dir":"Articles","previous_headings":"Workflow > 1. Create an aftable","what":"Pre-prepare tables","title":"Introduction to {aftables}","text":"Rather pass big list dataframes directly tables argument create_aftable(), ’s preferable prepare first named objects. demo tables later pass create_aftable(). ’ve used tibble::tribble() human-readable row--row dataframe construction, can just use data.frame() want. Note can use RStudio Addin ‘Insert table templates using ’tibble’’ ‘Insert table templates using ’data.frame’’ insert demo skeleton R script.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/articles/aftables.html","id":"meta-sheets","dir":"Articles","previous_headings":"Workflow > 1. Create an aftable > Pre-prepare tables","what":"Meta-sheets","title":"Introduction to {aftables}","text":"cover can accept either list data.frame (latter acceptable input prior version 0.2.0). recommend list can multiple rows per section cover. also means can dedicate certain rows hyperlinks web URLs mailto links open email client. ’s demo list contents page (required): Note: list preferred method input cover. Previously, data.frame way supply data cover sheet version 0.1 package. ’s demo table contents page (required): ’s demo table notes page (required ’s notes tables), column note number form ‘[note x]’ column note :","code":"cover_list <- list(   \"Section 1\" = c(\"First row of Section 1.\", \"Second row of Section 1.\"),   \"Section 2\" = \"The only row of Section 2.\",   \"Section 3\" = c(     \"[Website](https://best-practice-and-impact.github.io/aftables/)\",     \"[Email address](mailto:fake.address@aftables.com)\"   ) ) contents_df <- data.frame(   \"Sheet name\" = c(\"Notes\", \"Table_1\", \"Table_2\"),   \"Sheet title\" = c(     \"Notes used in this workbook\",     \"First Example Sheet\",     \"Second Example Sheet\"   ),   check.names = FALSE ) notes_df <- data.frame(   \"Note number\" = paste0(\"[note \", 1:3, \"]\"),   \"Note text\" = c(\"First note.\", \"Second note.\", \"Third note.\"),   check.names = FALSE ) cover_list # $`Section 1` # [1] \"First row of Section 1.\"  \"Second row of Section 1.\" #  # $`Section 2` # [1] \"The only row of Section 2.\" #  # $`Section 3` # [1] \"[Website](https://best-practice-and-impact.github.io/aftables/)\" # [2] \"[Email address](mailto:fake.address@aftables.com)\" contents_df #   Sheet name                 Sheet title # 1      Notes Notes used in this workbook # 2    Table_1         First Example Sheet # 3    Table_2        Second Example Sheet notes_df #   Note number    Note text # 1    [note 1]  First note. # 2    [note 2] Second note. # 3    [note 3]  Third note."},{"path":"https://best-practice-and-impact.github.io/aftables/articles/aftables.html","id":"statistical-tables","dir":"Articles","previous_headings":"Workflow > 1. Create an aftable > Pre-prepare tables","what":"Statistical tables","title":"Introduction to {aftables}","text":"code generates demo data.frame ’re going pretend statistical data want publish. columns different sorts data might want publish. also suppressed values (e.g. ‘[c]’ meaning ‘confidential’ data) includes notes (form ‘[note x]’). ’ll create second, simpler table well, go separate sheet: See best practice guidance information present data tables.","code":"table_1_df <- data.frame(   Category = LETTERS[1:10],   \"Numeric [note 1]\" = 1:10,   \"Numeric suppressed\" = c(1:4, \"[c]\", 6:9, \"[x]\"),   \"Numeric thousands\" = abs(round(rnorm(10), 4) * 1e5),   \"Numeric decimal\" = abs(round(rnorm(10), 5)),   \"Long name that means that the column width needs to be widened\" = 1:10,   Notes = c(\"[note 1]\", rep(NA_character_, 4), \"[note 2]\", rep(NA_character_, 4)),   check.names = FALSE ) table_2_df <- data.frame(Category = LETTERS[1:10], Numeric = 1:10) table_1_df #    Category Numeric [note 1] Numeric suppressed Numeric thousands # 1         A                1                  1            140000 # 2         B                2                  2             25530 # 3         C                3                  3            243730 # 4         D                4                  4               560 # 5         E                5                [c]             62160 # 6         F                6                  6            114840 # 7         G                7                  7            182180 # 8         H                8                  8             24730 # 9         I                9                  9             24420 # 10        J               10                [x]             28270 #    Numeric decimal # 1          0.55370 # 2          0.62898 # 3          2.06502 # 4          1.63099 # 5          0.51243 # 6          1.86301 # 7          0.52201 # 8          0.05260 # 9          0.54300 # 10         0.91407 #    Long name that means that the column width needs to be widened    Notes # 1                                                               1 [note 1] # 2                                                               2     <NA> # 3                                                               3     <NA> # 4                                                               4     <NA> # 5                                                               5     <NA> # 6                                                               6 [note 2] # 7                                                               7     <NA> # 8                                                               8     <NA> # 9                                                               9     <NA> # 10                                                             10     <NA> table_2_df #    Category Numeric # 1         A       1 # 2         B       2 # 3         C       3 # 4         D       4 # 5         E       5 # 6         F       6 # 7         G       7 # 8         H       8 # 9         I       9 # 10        J      10"},{"path":"https://best-practice-and-impact.github.io/aftables/articles/aftables.html","id":"create-aftable","dir":"Articles","previous_headings":"Workflow > 1. Create an aftable","what":"Create aftable","title":"Introduction to {aftables}","text":"Now can construct aftable passing required sheet elements character vectors c()—list() case tables custom_rows arguments—create_aftable() function. Note : element index object supplied argument sheet applied (e.g. tab title first sheet ‘Cover’, sheet type second sheet ‘contents’ fourth sheet contain table_1_df table) must use NA_character_ wherever element isn’t required (e.g. information blank cells sources first three sheets) can insert template demo using package’s RStudio Addin function return errors warnings anything missing seems odd. example, warned value supplied tab_title cleaned ‘Table 1’ ‘Table_1’, since blank spaces allowed tab names. Note error tab titles start numeral. ’s preview object created: can immediately tell aftable ’s first word ’s printed output. aftable basically just table one row per sheet one column per sheet element. fact, class ‘data.frame’/‘tbl’ along ‘aftable’. convenience, can also check aftable class is_aftable(). Note create_aftable() preferred method generating aftable-class objects, ’s also possible convert correctly-formatted, pre-built data.frame tibble directly aftable as_aftable().","code":"my_aftable <- aftables::create_aftable(   tab_titles = c(\"Cover\", \"Contents\", \"Notes\", \"Table 1\", \"Table_2\"),   sheet_types = c(\"cover\", \"contents\", \"notes\", \"tables\", \"tables\"),   sheet_titles = c(     \"The 'aftables' Demo Workbook\",     \"Table of contents\",     \"Notes\",     \"Table 1: First Example Sheet\",     \"Table 2: Second Example Sheet\"   ),   blank_cells = c(     rep(NA_character_, 3),     \"Blank cells indicate that there's no note in that row.\",     NA_character_   ),   custom_rows = list(     NA_character_,     NA_character_,     \"A custom row.\",     c(       \"First custom row [with a hyperlink.](https://best-practice-and-impact.github.io/aftables/)\",       \"Second custom row.\"     ),     \"A custom row.\"   ),   sources = c(     rep(NA_character_, 3),     \"[The Source Material., 2024](https://best-practice-and-impact.github.io/aftables/)\",     \"The Source Material, 2024.\"   ),   tables = list(cover_list, contents_df, notes_df, table_1_df, table_2_df) ) # Warning: These tab_titles have been cleaned automatically: Table 1 (now # Table_1). # Warning: Some notes are in the notes sheet (3) but are missing from the tables. my_aftable # # aftable: 5 x 7 #   tab_title sheet_type sheet_title   blank_cells source custom_rows table        #   <chr>     <chr>      <chr>         <chr>       <chr>  <list>      <list>       # 1 Cover     cover      The 'aftable… NA          NA     <chr [1]>   <named list> # 2 Contents  contents   Table of con… NA          NA     <chr [1]>   <df [3 × 2]> # 3 Notes     notes      Notes         NA          NA     <chr [1]>   <df [3 × 2]> # 4 Table_1   tables     Table 1: Fir… Blank cell… [The … <chr [2]>   <df>         # 5 Table_2   tables     Table 2: Sec… NA          The S… <chr [1]>   <df>"},{"path":"https://best-practice-and-impact.github.io/aftables/articles/aftables.html","id":"convert-to-a-workbook","dir":"Articles","previous_headings":"Workflow","what":"2. Convert to a workbook","title":"Introduction to {aftables}","text":"can use generate_workbook() convert aftable {openxlsx} Workbook-class object. type object adds information row aftable separate sheets applies relevant structure, mark-styles compliance best practice guidance. print method Workbook-class object fairly limited, can see overview named sheets custom styling.","code":"my_wb <- aftables::generate_workbook(my_aftable) my_wb # A Workbook object. #   # Worksheets: #  Sheet 1: \"Cover\" #   #   Custom row heights (row: height) #    2: 34, 5: 34, 7: 34  #   Custom column widths (column: width) #     1: 72  #   #  #  Sheet 2: \"Contents\" #   #   Custom column widths (column: width) #     1: 16, 2: 56  #   #  #  Sheet 3: \"Notes\" #   #   Custom column widths (column: width) #     1: 16, 2: 56  #   #  #  Sheet 4: \"Table_1\" #   #   Custom column widths (column: width) #     1: 16, 2: 16, 3: 16, 4: 16, 5: 16, 6: 32, 7: 16  #   #  #  Sheet 5: \"Table_2\" #   #   Custom column widths (column: width) #     1: 16, 2: 16  #   #  #   #  Worksheet write order: 1, 2, 3, 4, 5 #  Active Sheet 1: \"Cover\"  #   Position: 1"},{"path":"https://best-practice-and-impact.github.io/aftables/articles/aftables.html","id":"write-to-file","dir":"Articles","previous_headings":"Workflow","what":"3. Write to file","title":"Introduction to {aftables}","text":"Finally, can use saveWorkbook() function {openxlsx} write workbook object xlsx file (set filename argument location suitable work). also open temporary copy workbook openxlsx::openXL(), convenient development process.","code":"openxlsx::saveWorkbook(my_wb, \"publication.xlsx\")"},{"path":"https://best-practice-and-impact.github.io/aftables/articles/aftables.html","id":"output","dir":"Articles","previous_headings":"Workflow > 3. Write to file","what":"Output","title":"Introduction to {aftables}","text":"content output spreadsheet end looking something like :  ’ll notice various best-practice formatting (e.g. Arial size 12 font body text) mark-(e.g. tables, donated marker lower-right corner lower-right cell one) applied throughout. Note also two ‘pre-table’ meta-elements created automatically sheets contain statistical tables, didn’t need supply create_aftable(): (1) number tables (2) presence notes. required accessibility good practice.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/articles/aftables.html","id":"final-tweaks","dir":"Articles","previous_headings":"Workflow > 3. Write to file","what":"Final tweaks","title":"Introduction to {aftables}","text":"’s responsibility check amend output {aftables} ensure meets users’ accessibility needs. can apply final tweaks output xlsx file defaults don’t quite meet requirements (e.g. column widths), though ’s advisable keep changes minimum reproducibility purposes may undo compliant structuring formatting {aftables} provides. time writing (v0.3.0) might want address manually accessibility requirements yet covered package: Fill document properties, likely find ‘File’ ‘Properties’ spreadsheet software Convert ODS file rather proprietary xlsx format Various number-formatting issues, like padding decimal places zeroes ’re trying address number limitations. Please see issues GitHub current status.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/articles/aftables.html","id":"contribute","dir":"Articles","previous_headings":"","what":"Contribute","title":"Introduction to {aftables}","text":"contribute, please add issue pull request reading code conduct contributing guidance.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/articles/checklist.html","id":"purpose","dir":"Articles","previous_headings":"","what":"Purpose","title":"Accessibility guidance checklist","text":"vignette shows {aftables} meets accessibility best practice.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/articles/checklist.html","id":"checklists","dir":"Articles","previous_headings":"","what":"Checklists","title":"Accessibility guidance checklist","text":"page shows features {aftables} package meet Analysis Function’s ‘Making spreadsheets accessible: checklist basics’ guidance. assessments table based generating unedited output typical {aftables} workflow, .e. use create_aftable() make aftable ’s passed generate_workbook() written openxlsx::saveWorkbook(). several self-assessed indicators used ‘status’ column tables : ‘met’ means {aftables} contains feature (absence feature) help meet requirement ‘user’s responsibility’ means user must make decision meet requirement ‘partly’ means {aftables} contains feature help meet requirement, user may need provide additional input ‘applicable’ means checklist item need met due way {aftables} works","code":""},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":"https://best-practice-and-impact.github.io/aftables/articles/checklist.html","id":"contribute","dir":"Articles","previous_headings":"","what":"Contribute","title":"Accessibility guidance checklist","text":"contribute, please add issue pull request reading code conduct contributing guidance.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/articles/structure.html","id":"purpose","dir":"Articles","previous_headings":"","what":"Purpose","title":"Package structure","text":"vignette aimed developers want understand package better make easier contribute.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/articles/structure.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Package structure","text":"two main user-facing functions {aftables}: create_aftable() create data.frame object (additional ‘aftable’ S3 class) filled information needed create spreadsheet output, well check validity structure provide errors warnings generate_workbook() convert output create_aftable() {openxlsx} Workbook-class object, ready writing xlsx file openxlsx::saveWorkbook() simplicity feature, bug. ’s designed greatly simplify process creating compliant spreadsheets. package hard work making outputs compliant user spends less time dealing . vignette provides quick look ’s happening ‘hood’ functions. Please add issue package’s GitHub repository like explanation expanded, provide solution pull request.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/articles/structure.html","id":"files","dir":"Articles","previous_headings":"","what":"Files","title":"Package structure","text":"First ’s worth explaining source files laid . four major groups scripts R/ directory package: Code make aftable-class objects: aftable.R utils-aftable.R contain code handling aftable class, importantly create_aftable() function, also coercion as_aftable(), checking is_aftable(), summary() method print() method, takes advantage {pillar} package prettier outputs. Code make Workbook-class objects: workbook.R, utils-workbook.R utils-workbook-style.R contain code creating styling Workbook-class object generate_workbook() function. Code produce demo datasets: data.R contains documentation demo datasets, created data-raw/ directory files stored data/ directory. Code creates RStudio Addin: addin.R utils-addin.R contain code RStudio Addin (.dcf file inst/rstudio/ directory). ’ll also find aftables-package.R file R/ directory, provides package-level help page derived DESCRIPTION file ?aftables run user. doesn’t need edited.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/articles/structure.html","id":"code","dir":"Articles","previous_headings":"","what":"Code","title":"Package structure","text":"sections focus create_aftable() generate_workbook() functions, primary complex functions package. code underpins functions modularised aid bug-catching testing, also make easier developers understand code fits together. Internal sub-functions consistently-named begin verbs, help better understand purpose. Note {aftables} uses convention internal functions (.e. presented user, accessed via ::: qualifier) prefixed period (.e. .f()) make clearer internal package. exported user-facing functions use leading period.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/articles/structure.html","id":"to-create-aftables","dir":"Articles","previous_headings":"Code","what":"To create aftables","title":"Package structure","text":"Actually, create_aftable() one thing: takes user inputs arguments combines dataframe. passes important function package, as_aftable(), responsible coercing dataframe aftable class performing checks content. Basically, as_aftable() creates S3-class object classes ‘data.frame’ ‘tbl’ (.e. tibble) additional ‘aftable’ class. object can manipulated like ‘normal’ dataframe —thanks {pillar} package tbl class—can printed compact form without need whole {tibble} package imported. Compare appearance regular data.frame, trickier understand: Within as_aftable() two major functions help ensure proper construction aftable object: .validate_aftable() generate errors basic structural expectations aftable aren’t met (e.g. ‘cover’, ‘contents’ ‘notes’ provided sheet_type argument) .warn_aftable() checks things user may forgotten prints warnings (e.g. 5 notes declared notes sheet fewer tables ) Advanced users can create correctly-formatted data.frame fly convert aftable as_aftable() directly. as_aftable() function mainly exists make testing easier, .e. can pass pre-prepared demo_df dataset.","code":"library(aftables) my_aftable <- as_aftable(demo_df) class(my_aftable) # [1] \"aftable\"    \"tbl\"        \"data.frame\" my_aftable # # aftable: 5 x 7 #   tab_title sheet_type sheet_title   blank_cells source custom_rows table        #   <chr>     <chr>      <chr>         <chr>       <chr>  <list>      <list>       # 1 Cover     cover      The 'aftable… NA          NA     <chr [1]>   <named list> # 2 Contents  contents   Table of con… NA          NA     <chr [1]>   <df [3 × 2]> # 3 Notes     notes      Notes         NA          NA     <chr [1]>   <df [3 × 2]> # 4 Table_1   tables     Table_1: Fir… Blank cell… [The … <chr [2]>   <df>         # 5 Table_2   tables     Table_2: Sec… NA          The S… <chr [1]>   <df> as.data.frame(my_aftable) #   tab_title sheet_type                   sheet_title # 1     Cover      cover  The 'aftables' Demo Workbook # 2  Contents   contents             Table of contents # 3     Notes      notes                         Notes # 4   Table_1     tables  Table_1: First Example Sheet # 5   Table_2     tables Table_2: Second Example Sheet #                                              blank_cells # 1                                                   <NA> # 2                                                   <NA> # 3                                                   <NA> # 4 Blank cells indicate that there's no note in that row. # 5                                                   <NA> #                                                                               source # 1                                                                               <NA> # 2                                                                               <NA> # 3                                                                               <NA> # 4 [The Source Material, 2024.](https://best-practice-and-impact.github.io/aftables/) # 5                                                         The Source Material, 2024. #                                                                                                      custom_rows # 1                                                                                                             NA # 2                                                                                                             NA # 3                                                                                                  A custom row. # 4 First custom row [with a hyperlink.](https://best-practice-and-impact.github.io/aftables/), Second custom row. # 5                                                                                                  A custom row. #                                                                                                                                                                                                                                                                                                                                              table # 1                                                                                                                                                First row of Section 1., Second row of Section 1., The only row of Section 2., [Website](https://best-practice-and-impact.github.io/aftables/), [Email address](mailto:fake.address@aftables.com) # 2                                                                                                                                                                                                                                                  Notes, Table 1, Table 2, Notes used in this workbook, First Example Sheet, Second Example Sheet # 3                                                                                                                                                                                                                                                                             [note 1], [note 2], [note 3], First note., Second note., Third note. # 4 A, B, C, D, E, F, G, H, I, J, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 1, 2, 3, 4, [c], 6, 7, 8, 9, [x], 59180, 29260, 92130, 24000, 91970, 78650, 281050, 97720, 174630, 15230, 0.56094, 0.27176, 0.47238, 0.62704, 0.01278, 0.01788, 0.31304, 1.276, 0.54384, 0.81019, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, [note 2], NA, NA, NA, NA, [note 3], NA, NA, NA, NA # 5                                                                                                                                                                                                                                                                                      A, B, C, D, E, F, G, H, I, J, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10"},{"path":"https://best-practice-and-impact.github.io/aftables/articles/structure.html","id":"methods","dir":"Articles","previous_headings":"Code > To create aftables","what":"Methods","title":"Package structure","text":"’s methods aftables also found R/aftables.R. is_aftable() classic logical test checks aftable class object provided . summary() method prints simple overview provided aftable. tbl_sum() method provided via {pillar} package, goal providing bespoke header printed aftable.","code":"is_aftable(my_aftable) # [1] TRUE summary(my_aftable) # # An aftable with 5 sheets:  #   1) Tab 'Cover' (sheet type 'cover') contains a list of length 3 (element lengths 2, 1 and 2) #   2) Tab 'Contents' (sheet type 'contents') contains a 3 x 2 dataframe #   3) Tab 'Notes' (sheet type 'notes') contains a 3 x 2 dataframe #   4) Tab 'Table_1' (sheet type 'tables') contains a 10 x 7 dataframe #   5) Tab 'Table_2' (sheet type 'tables') contains a 10 x 2 dataframe pillar::tbl_sum(my_aftable) # aftable  # \"5 x 7\""},{"path":"https://best-practice-and-impact.github.io/aftables/articles/structure.html","id":"to-create-workbooks","dir":"Articles","previous_headings":"Code","what":"To create workbooks","title":"Package structure","text":"generate_workbook() function sets {openxlsx} Workbook-class object fills iterating user-supplied aftable-class object. can see Workbook-class object carries information determine structure style final spreadsheet output. Several internal sub-functions within generate_workbook()—.add_*(), .insert_*() .style_*()—responsible adding sheets, inserting sheet elements styling , respectively.","code":"my_wb <- generate_workbook(my_aftable) class(my_wb) # [1] \"Workbook\" # attr(,\"package\") # [1] \"openxlsx\" my_wb # A Workbook object. #   # Worksheets: #  Sheet 1: \"Cover\" #   #   Custom row heights (row: height) #    2: 34, 5: 34, 7: 34  #   Custom column widths (column: width) #     1: 72  #   #  #  Sheet 2: \"Contents\" #   #   Custom column widths (column: width) #     1: 16, 2: 56  #   #  #  Sheet 3: \"Notes\" #   #   Custom column widths (column: width) #     1: 16, 2: 56  #   #  #  Sheet 4: \"Table_1\" #   #   Custom column widths (column: width) #     1: 16, 2: 16, 3: 16, 4: 16, 5: 16, 6: 32, 7: 16  #   #  #  Sheet 5: \"Table_2\" #   #   Custom column widths (column: width) #     1: 16, 2: 16  #   #  #   #  Worksheet write order: 1, 2, 3, 4, 5 #  Active Sheet 1: \"Cover\"  #   Position: 1"},{"path":"https://best-practice-and-impact.github.io/aftables/articles/structure.html","id":"add-sheets","dir":"Articles","previous_headings":"Code > To create workbooks","what":"Add sheets","title":"Package structure","text":"Workbook-class object first created openxlsx::createWorkbook() sheets added based contents user-supplied aftable. following functions add sheets sheet elements workbook: .add_tabs() adds required number tabs workbook openxlsx::addWorksheet() (per tab_title column supplied aftable) .add_cover() .add_contents() add information needed cover contents sheets (per required ‘cover’ ‘contents’ supplied sheet_type column aftable) .add_notes() notes sheet exists (.e. row supplied aftable sheet_type ‘notes’) .add_table() adds sheets statistical table (per rows supplied aftable sheet_type ‘table’) sheets added, content inserted styles applied : .insert_*() functions, insert sheet elements (title, source statement, table, etc) sheet .style_*() functions, apply formatting sheet (e.g. bold sheet titles larger font) workbook (e.g. Arial font)","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/articles/structure.html","id":"insert-sheet-elements","dir":"Articles","previous_headings":"Code > To create workbooks > Add sheets","what":"Insert sheet elements","title":"Package structure","text":"several .insert_*() functions add information sheet depending sheet_type provided aftable, well content, , sheet_title, blank_cells, source table columns. following functions insert ‘pre-table’ elements order: .insert_title() place sheet title cell A1 .insert_table_count() add statement number tables sheet .insert_notes_statement() sheet_type ‘notes’ provided user’s aftable .insert_blanks_message() content provided blanks_cells column user’s aftable .insert_custom_rows() content provided custom_rows column user’s aftable .insert_source() content provided source column user’s aftable table data added metadata .insert_table(), provided table column user’s aftable object. exact .insert_*() functions called depend sheet_type declared aftable: meta sheets (cover, contents notes) need .insert_title() .insert_table_count() statistical tables may also require .insert_blanks_message(), .insert_custom_rows() .insert_source() relevant content provided user, well .insert_notes_statement() notes Simple logic used check presence meta elements .has_*() functions, get_start_row_*() functions handle cell message inserted. example, elements supplied, table begin row 6 (.e. sheet title, table count, note presence, meaning blank cells source), ’s possible table inserted row 3 sheet title statement required. avoids inaccessible blank rows redundant statements like ‘table source statement’.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/articles/structure.html","id":"apply-styles","dir":"Articles","previous_headings":"Code > To create workbooks > Add sheets","what":"Apply styles","title":"Package structure","text":".style_*() functions create styles apply basis sheet_type provided aftable. .style_create() creates easily-referenced lookup styles, created openxlsx::createStyle() .style_workbook() applies defaults whole workbook (.e. set font style Arial size 12) .style_cover(), .style_contents() .style_notes() apply styles specific sheets .style_sheet_title() .style_table() apply styles particular sheet elements (e.g. title larger bolder default font)","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/articles/structure.html","id":"contribute","dir":"Articles","previous_headings":"","what":"Contribute","title":"Package structure","text":"contribute, please add issue pull request reading code conduct contributing guidance.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/articles/terminology.html","id":"purpose","dir":"Articles","previous_headings":"","what":"Purpose","title":"Spreadsheet terminology","text":"vignette provides quick lookup spreadsheet nomenclature, used {aftables} package.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/articles/terminology.html","id":"terminology","dir":"Articles","previous_headings":"","what":"Terminology","title":"Spreadsheet terminology","text":"Certain language conventions used package talk spreadsheets. workbook spreadsheet-like structure. contains tabs named unique tab title. tab contains sheet. Sheets can one four sheet types dictate content, layout style: cover sheet contains title workbook information data contains, produced , etc contents sheet contains table showing contents workbook glance, one row per sheet (including cover ) notes sheet contains table lookup note codes (e.g. ‘[note 1]’) explanations One tables sheets contain statistical tables (main purpose existence spreadsheet) annexes supporting information cover, contents notes sheets can considered meta sheets provide contextual information workbook contents. Sheets composed inserted elements appear following row order (present): sheet title displayed top sheet (user-provided) table count users know many tables sheet (auto-generated) notes statement declares table contains notes (applicable, auto-generated) blank cells statement indicates meaning behind blank cells table (applicable, user-provided) source statement explain data came (applicable, user-provided) table contains information rows columns (user-provided) table name (auto-generated) appears ‘name’ marked-table","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/articles/terminology.html","id":"example","dir":"Articles","previous_headings":"","what":"Example","title":"Spreadsheet terminology","text":"example xlsx output {aftables} package:  labels image highlight: tabs tab titles, open sheet called ‘Table_1’ (meta sheets currently hidden). sheet title. Several elements: table count, notes statement (table contains notes), blank cells statement (table contains blank cells) source statement data. marked-table, contains suppressed values (.e. ‘[c]’) notes (e.g. ‘[note 1]’).","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/articles/terminology.html","id":"contribute","dir":"Articles","previous_headings":"","what":"Contribute","title":"Spreadsheet terminology","text":"contribute, please add issue pull request reading code conduct contributing guidance.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Matt Dray. Author. Tim Taylor. Contributor. Matt Kerlogue. Contributor. Crown Copyright. Copyright holder. Olivia Box Power. Maintainer, contributor.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Dray M (2021). aftables: Generate spreadsheet publications follow best practice guidance UK government's Analysis Function. https://github.com/best-practice--impact/aftables.","code":"@Manual{,   title = {aftables: Generate spreadsheet publications that follow best practice guidance from the UK government's Analysis Function},   author = {Matt Dray},   year = {2021},   url = {https://github.com/best-practice-and-impact/aftables}, }"},{"path":[]},{"path":"https://best-practice-and-impact.github.io/aftables/index.html","id":"purpose","dir":"","previous_headings":"","what":"Purpose","title":"Create Spreadsheet Publications Following Best Practice","text":"R package help automatically create reproducible spreadsheets adhere guidance releasing statistics spreadsheets UK government’s Analysis Function, focus accessibility. Visit {aftables} website documentation.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/index.html","id":"accessibility","dir":"","previous_headings":"","what":"Accessibility","title":"Create Spreadsheet Publications Following Best Practice","text":"package yet capable creating perfectly accessible spreadsheets help bulk work needed. Users packages refer back main spreadsheet guidance spreadsheet accessibility checklist using make sure nothing missed. Please email analysis.function@ons.gov.uk use package can monitor use outputs produced.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/index.html","id":"contribute","dir":"","previous_headings":"","what":"Contribute","title":"Create Spreadsheet Publications Following Best Practice","text":"package (opinionated) active development. Please see NEWS file latest changes. contribute, please add issue pull request reading code conduct contributing guidance.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/index.html","id":"install","dir":"","previous_headings":"","what":"Install","title":"Create Spreadsheet Publications Following Best Practice","text":"Install package GitHub using {remotes}.","code":"install.packages(\"remotes\")  # if not already installed  remotes::install_github(   repo = \"best-practice-and-impact/aftables\",  # GitHub user/repository   dependencies = TRUE,              # install required/suggested packages   build_vignettes = TRUE            # generate vignette documentation )  library(aftables)  # attach package"},{"path":"https://best-practice-and-impact.github.io/aftables/index.html","id":"how-to-install-a11ytables","dir":"","previous_headings":"","what":"How to install a11ytables","title":"Create Spreadsheet Publications Following Best Practice","text":"original name aftables package a11ytables. package renamed make consistent afcharts package. function names updated package renamed. need install a11ytables legacy project, following code can used.","code":"install.packages(\"remotes\")  # if not already installed  remotes::install_github(   repo = \"best-practice-and-impact/aftables\",  # GitHub user/repository   ref = \"v0.3.2\", # this installs the final version of a11ytables. Change if you need an earlier version.   dependencies = TRUE,              # install required/suggested packages   build_vignettes = TRUE            # generate vignette documentation )  library(a11ytables)  # attach package"},{"path":"https://best-practice-and-impact.github.io/aftables/index.html","id":"use","dir":"","previous_headings":"","what":"Use","title":"Create Spreadsheet Publications Following Best Practice","text":"create spreadsheet: Use create_aftable() Pass output generate_workbook() Pass output openxlsx::saveWorkbook() Run ?function_name visit package website function documentation. long-form documentation, visit package website run browseVignettes(\"aftables\") read : introductory vignette get started accessibility checklist vignette see package complies best-practice guidance terminology vignette understand nomenclature spreadsheet terms used package package structure vignette see package works hood package also includes RStudio Addin inserts pre-filled demo skeletons {aftables} workflow.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/index.html","id":"related-projects","dir":"","previous_headings":"","what":"Related projects","title":"Create Spreadsheet Publications Following Best Practice","text":"ONS’s Analysis Standards Pipelines team released Python package called ‘gptables’. {aftables} independent effort offers native R solution similar gptables outputs, though differences implementation. {aftables} can help fulfill Reproducible Analytical Pipeline automating generation compliant spreadsheets publication.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/index.html","id":"code-of-conduct","dir":"","previous_headings":"","what":"Code of Conduct","title":"Create Spreadsheet Publications Following Best Practice","text":"Please note {aftables} project released Contributor Code Conduct.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/index.html","id":"copyright-and-licensing","dir":"","previous_headings":"","what":"Copyright and Licensing","title":"Create Spreadsheet Publications Following Best Practice","text":"© Crown Copyright, 2023. work Crown Copyright. source code software released MIT licence per UK Government Licensing Framework GDS Way licensing guidance. documentation software released Open Government Licence.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/reference/aftables-package.html","id":null,"dir":"Reference","previous_headings":"","what":"aftables: Create Spreadsheet Publications Following Best Practice — aftables-package","title":"aftables: Create Spreadsheet Publications Following Best Practice — aftables-package","text":"Generate spreadsheet publications follow best practice guidance UK government's Analysis Function, focus accessibility. Based 'openxlsx'. See also Python package 'gptables'.","code":""},{"path":[]},{"path":"https://best-practice-and-impact.github.io/aftables/reference/aftables-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"aftables: Create Spreadsheet Publications Following Best Practice — aftables-package","text":"Maintainer: Olivia Box Power Olivia.BoxPower@dhsc.gov.uk [contributor] Authors: Matt Dray mwdray@gmail.com contributors: Tim Taylor [contributor] Matt Kerlogue [contributor] Crown Copyright [copyright holder]","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/reference/as_aftable.html","id":null,"dir":"Reference","previous_headings":"","what":"Coerce To An 'aftable' Object — as_aftable","title":"Coerce To An 'aftable' Object — as_aftable","text":"Functions check object aftable, coerce possible.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/reference/as_aftable.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Coerce To An 'aftable' Object — as_aftable","text":"","code":"as_aftable(x)  is_aftable(x)"},{"path":"https://best-practice-and-impact.github.io/aftables/reference/as_aftable.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Coerce To An 'aftable' Object — as_aftable","text":"x data.frame object coerce.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/reference/as_aftable.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Coerce To An 'aftable' Object — as_aftable","text":"as_aftable returns object class aftable possible. is_aftable returns TRUE object class aftable, otherwise FALSE.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/reference/as_aftable.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Coerce To An 'aftable' Object — as_aftable","text":"","code":"as_aftable(demo_df) #> # aftable: 5 x 7 #>   tab_title sheet_type sheet_title   blank_cells source custom_rows table        #>   <chr>     <chr>      <chr>         <chr>       <chr>  <list>      <list>       #> 1 Cover     cover      The 'aftable… NA          NA     <chr [1]>   <named list> #> 2 Contents  contents   Table of con… NA          NA     <chr [1]>   <df [3 × 2]> #> 3 Notes     notes      Notes         NA          NA     <chr [1]>   <df [3 × 2]> #> 4 Table_1   tables     Table_1: Fir… Blank cell… [The … <chr [2]>   <df>         #> 5 Table_2   tables     Table_2: Sec… NA          The S… <chr [1]>   <df>         is_aftable(demo_aftable) #> [1] TRUE"},{"path":"https://best-practice-and-impact.github.io/aftables/reference/at_template_aftable.html","id":null,"dir":"Reference","previous_headings":"","what":"Insert Demo 'create_aftable' Template — at_template_aftable","title":"Insert Demo 'create_aftable' Template — at_template_aftable","text":"Insert cursor template create_aftable 'aftable' package, pre-filled demo data.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/reference/at_template_aftable.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Insert Demo 'create_aftable' Template — at_template_aftable","text":"","code":"at_template_aftable()"},{"path":"https://best-practice-and-impact.github.io/aftables/reference/at_template_aftable.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Insert Demo 'create_aftable' Template — at_template_aftable","text":"Empty list. Function used side effect.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/reference/at_template_workflow.html","id":null,"dir":"Reference","previous_headings":"","what":"Insert Full Demo 'aftables' Template Workflow — at_template_workflow","title":"Insert Full Demo 'aftables' Template Workflow — at_template_workflow","text":"Insert cursor () demo templates cover, contents notes tables, (b) call create_aftable pre-filled demo data.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/reference/at_template_workflow.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Insert Full Demo 'aftables' Template Workflow — at_template_workflow","text":"","code":"at_template_workflow()"},{"path":"https://best-practice-and-impact.github.io/aftables/reference/at_template_workflow.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Insert Full Demo 'aftables' Template Workflow — at_template_workflow","text":"Empty list. Function used side effect.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/reference/create_aftable.html","id":null,"dir":"Reference","previous_headings":"","what":"Create An 'aftable' Object — create_aftable","title":"Create An 'aftable' Object — create_aftable","text":"Create new aftable-class object, special data.frame contains information needed output spreadsheet. turn, object created function can used populate 'openxlsx' Workbook-class object function generate_workbook.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/reference/create_aftable.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create An 'aftable' Object — create_aftable","text":"","code":"create_aftable(   tab_titles,   sheet_types = c(\"cover\", \"contents\", \"notes\", \"tables\"),   sheet_titles,   blank_cells = NA_character_,   sources = NA_character_,   custom_rows = list(NA_character_),   tables )"},{"path":"https://best-practice-and-impact.github.io/aftables/reference/create_aftable.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create An 'aftable' Object — create_aftable","text":"tab_titles Required character vector, one value per sheet. title appear literally tab final spreadsheet output. Keep brief. Letters numbers ; start number; use underscores spaces. example: 'Cover', 'Contents', 'Notes', 'Table_1'. corrected automatically unless error. sheet_types Required character vector, one value per sheet. Sheets contain publication tables ('meta' sheets) type 'contents', 'cover' 'notes'. Sheets contain statistical tables data type 'tables'. sheet_titles Required character vector, one value per sheet. main title sheet, appear cell A1 (top-left corner). blank_cells Optional character vector, one value per sheet. short sentence explain reason blank cells sheet. Supply NA_character_ empty. likely used sheet type 'tables'. sources Optional character vector, one value per sheet. origin data given sheet. Supply NA_character_ empty. used sheet type 'tables'. custom_rows Optional list character vectors. One list element per sheet, one character vector element per row pre-table metadata. Supply list element NA_character_ empty. used sheet type 'tables', can also used sheet types 'contents' 'notes'. tables Required list data.frames (though cover sheet may supplied list), one per sheet. See details.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/reference/create_aftable.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create An 'aftable' Object — create_aftable","text":"object classes 'aftable', 'tbl' 'data.frame'.","code":""},{"path":[]},{"path":"https://best-practice-and-impact.github.io/aftables/reference/create_aftable.html","id":"how-to-supply-data-to-the-tables-argument","dir":"Reference","previous_headings":"","what":"How to supply data to the 'tables' argument","title":"Create An 'aftable' Object — create_aftable","text":"Formats elements collected list passed 'tables' argument, depending sheet type. Sheet type 'cover': either () list element name section header element's content character vector whose elements make separate rows section (recommended), (b) data.frame one row per subsection, one column section titles one column corresponding section's body text. example, may section title 'Contact details' contains email address telephone number. can use line breaks (.e. '\\n') separate text paragraphs. Sheet type 'contents': one row per sheet, two columns suggested least (named 'Tab title' 'Worksheet title'). Sheet type 'notes': one row per note, two columns suggested (named 'Note number', 'Note text'), notes form '[note 1]'. Sheet type 'tables': tidy, rectangular data.frame containing data published. user's responsibility add notes form '[note 1]' column headers, special 'Notes' row.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/reference/create_aftable.html","id":"how-to-supply-hyperlinks","dir":"Reference","previous_headings":"","what":"How to supply hyperlinks","title":"Create An 'aftable' Object — create_aftable","text":"can provide text Markdown link syntax (e.g. '[GOV.UK](https://www.gov.uk)', adding 'mailto:' email address) containing cell rendered hyperlink output spreadsheet. Note whole cells become hyperlinks; support selected words sentence rendered hyperlink. Hyperlinks can supplied character strings three arguments: 'tables' argument sheet type 'cover' . recommended supply cover information list rather data.frame, allow make specific rows within section (e.g. 'contact us') hyperlinks. 'custom_rows' argument sheets type 'contents, 'notes' 'tables'. 'source' argument sheets type 'table' .","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/reference/create_aftable.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create An 'aftable' Object — create_aftable","text":"","code":"# Prepare some demo tables of information  set.seed(1066)  cover_list <- list(   \"Section 1\" = c(\"First row of Section 1.\", \"Second row of Section 1.\"),   \"Section 2\" = \"The only row of Section 2.\",   \"Section 3\" = c(     \"[Website](https://best-practice-and-impact.github.io/aftables/)\",     \"[Email address](mailto:fake.address@aftables.com)\"   ) )  contents_df <- data.frame(   \"Sheet name\" = c(\"Notes\", \"Table_1\", \"Table_2\"),   \"Sheet title\" = c(     \"Notes used in this workbook\",     \"First Example Sheet\",     \"Second Example Sheet\"   ),   check.names = FALSE )  notes_df <- data.frame(   \"Note number\" = paste0(\"[note \", 1:2, \"]\"),   \"Note text\" = c(\"First note.\", \"Second note.\"),   check.names = FALSE )   table_1_df <- data.frame(   Category = LETTERS[1:10],   \"Numeric [note 1]\" = 1:10,   \"Numeric suppressed\" = c(1:4, \"[c]\", 6:9, \"[x]\"),   \"Numeric thousands\" = abs(round(rnorm(10), 4) * 1e5),   \"Numeric decimal\" = abs(round(rnorm(10), 5)),   \"Long name that means that the column width needs to be widened\" = 1:10,   Notes = c(\"[note 1]\", rep(NA_character_, 4), \"[note 2]\",             rep(NA_character_, 4)),   check.names = FALSE )  table_2_df <- data.frame(Category = LETTERS[1:10], Numeric = 1:10)  # Create 'aftables' object  x <- aftables::create_aftable(   tab_titles = c(\"Cover\", \"Contents\", \"Notes\", \"Table_1\", \"Table_2\"),   sheet_types = c(\"cover\", \"contents\", \"notes\", \"tables\", \"tables\"),   sheet_titles = c(     \"The 'aftables' Demo Workbook\",     \"Table of contents\",     \"Notes\",     \"Table 1: First Example Sheet\",     \"Table 2: Second Example Sheet\"   ),   blank_cells = c(     rep(NA_character_, 3),     \"Blank cells indicate that there's no note in that row.\",     NA_character_   ),   custom_rows = list(     NA_character_,     NA_character_,     \"A custom row.\",     c(       paste0(\"First custom row [with a hyperlink.]\",              \"(https://best-practice-and-impact.github.io/aftables/)\"),       \"Second custom row.\"     ),     \"A custom row.\"   ),   sources = c(     rep(NA_character_, 3),     paste0(\"[The Source Material, 2024.]\",#            \"(https://best-practice-and-impact.github.io/aftables/)\"),     \"The Source Material, 2024.\"   ),   tables = list(cover_list, contents_df, notes_df, table_1_df, table_2_df) )  # Test that 'aftable' is one of the object's classes is_aftable(x) #> [1] TRUE  # Look at the structure of the object str(x, max.level = 2) #> Classes ‘aftable’, ‘tbl’ and 'data.frame':\t5 obs. of  7 variables: #>  $ tab_title  : chr  \"Cover\" \"Contents\" \"Notes\" \"Table_1\" ... #>  $ sheet_type : chr  \"cover\" \"contents\" \"notes\" \"tables\" ... #>  $ sheet_title: chr  \"The 'aftables' Demo Workbook\" \"Table of contents\" \"Notes\" \"Table 1: First Example Sheet\" ... #>  $ blank_cells: chr  NA NA NA \"Blank cells indicate that there's no note in that row.\" ... #>  $ source     : chr  NA NA NA \"[The Source Material, 2024.](https://best-practice-and-impact.github.io/aftables/)\" ... #>  $ custom_rows:List of 5 #>   ..$ : chr NA #>   ..$ : chr NA #>   ..$ : chr \"A custom row.\" #>   ..$ : chr  \"First custom row [with a hyperlink.](https://best-practice-and-impact.github.io/aftables/)\" \"Second custom row.\" #>   ..$ : chr \"A custom row.\" #>  $ table      :List of 5 #>   ..$ :List of 3 #>   ..$ :'data.frame':\t3 obs. of  2 variables: #>   ..$ :'data.frame':\t2 obs. of  2 variables: #>   ..$ :'data.frame':\t10 obs. of  7 variables: #>   ..$ :'data.frame':\t10 obs. of  2 variables:"},{"path":"https://best-practice-and-impact.github.io/aftables/reference/demo_aftable.html","id":null,"dir":"Reference","previous_headings":"","what":"A Demo 'aftables' Object — demo_aftable","title":"A Demo 'aftables' Object — demo_aftable","text":"pre-created 'aftables' object ready converted 'openxlsx' Workbook-class object generate_workbook.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/reference/demo_aftable.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A Demo 'aftables' Object — demo_aftable","text":"","code":"demo_aftable"},{"path":"https://best-practice-and-impact.github.io/aftables/reference/demo_aftable.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"A Demo 'aftables' Object — demo_aftable","text":"data.frame 6 rows 7 columns: tab_title Character. Text appear sheet's tab. sheet_type Character. content type sheet: 'cover', 'contents', 'notes', 'tables'. sheet_title Character. title appear cell A1 (top-left) sheet. blank_cells Character. explanation blank cells table. custom_rows List-column character vectors. Additional arbitrary pre-table information provided user. source Character. origin data, relevant. table List-column data.frames (apart cover, list) containing statistical tables.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/reference/demo_df.html","id":null,"dir":"Reference","previous_headings":"","what":"A Demo 'data.frame' Object — demo_df","title":"A Demo 'data.frame' Object — demo_df","text":"pre-created data.frame ready converted aftables-class object as_aftable 'openxlsx' Workbook-class object generate_workbook.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/reference/demo_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A Demo 'data.frame' Object — demo_df","text":"","code":"demo_df"},{"path":"https://best-practice-and-impact.github.io/aftables/reference/demo_df.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"A Demo 'data.frame' Object — demo_df","text":"data.frame 6 rows 7 columns: tab_title Character. Text appear sheet's tab. sheet_type Character. content type sheet: 'cover', 'contents', 'notes', 'tables'. sheet_title Character. title appear cell A1 (top-left) sheet. blank_cells Character. explanation blank cells table. custom_rows List-column character vectors. Additional arbitrary pre-table information provided user. source Character. origin data, relevant. table List-column data.frames (apart cover, list) containing statistical tables.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/reference/demo_workbook.html","id":null,"dir":"Reference","previous_headings":"","what":"A Demo 'Workbook' Object — demo_workbook","title":"A Demo 'Workbook' Object — demo_workbook","text":"pre-created 'openxlsx' Workbook'-class object generated aftables-class object generate_workbook.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/reference/demo_workbook.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"A Demo 'Workbook' Object — demo_workbook","text":"","code":"demo_workbook"},{"path":"https://best-practice-and-impact.github.io/aftables/reference/demo_workbook.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"A Demo 'Workbook' Object — demo_workbook","text":"'openxlsx' Workbook-class object 5 sheets.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/reference/generate_workbook.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate A Workbook Object From An 'aftable' — generate_workbook","title":"Generate A Workbook Object From An 'aftable' — generate_workbook","text":"Populate 'openxlsx' Workbook-class object content aftable-class object. turn, output can passed saveWorkbook 'openxlsx'","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/reference/generate_workbook.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate A Workbook Object From An 'aftable' — generate_workbook","text":"","code":"generate_workbook(aftable)"},{"path":"https://best-practice-and-impact.github.io/aftables/reference/generate_workbook.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate A Workbook Object From An 'aftable' — generate_workbook","text":"aftable aftable-class object created using create_aftable (as_aftable), contains data information needed create workbook.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/reference/generate_workbook.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate A Workbook Object From An 'aftable' — generate_workbook","text":"Workbook-class object.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/reference/generate_workbook.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate A Workbook Object From An 'aftable' — generate_workbook","text":"","code":"# Convert an aftable to a Workbook-class object x <- generate_workbook(demo_aftable) class(x) #> [1] \"Workbook\" #> attr(,\"package\") #> [1] \"openxlsx\"  # As above, using a compliant data.frame and the base pipe y <- demo_df |>   as_aftable() |>   generate_workbook()"},{"path":"https://best-practice-and-impact.github.io/aftables/reference/summary.aftable.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarise An 'aftable' Object — summary.aftable","title":"Summarise An 'aftable' Object — summary.aftable","text":"concise result summary aftable-class object see information sheet content. Shows numbered list sheets tab title, sheet type table dimensions.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/reference/summary.aftable.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarise An 'aftable' Object — summary.aftable","text":"","code":"# S3 method for class 'aftable' summary(object, ...)"},{"path":"https://best-practice-and-impact.github.io/aftables/reference/summary.aftable.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarise An 'aftable' Object — summary.aftable","text":"object aftable-class object get summary. ... arguments pass.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/reference/summary.aftable.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarise An 'aftable' Object — summary.aftable","text":"object unaltered.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/reference/summary.aftable.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarise An 'aftable' Object — summary.aftable","text":"","code":"# Print a concise summary of the aftable-class object summary(demo_aftable) #> # An aftable with 5 sheets:  #>   1) Tab 'Cover' (sheet type 'cover') contains a list of length 3 (element lengths 2, 1 and 2) #>   2) Tab 'Contents' (sheet type 'contents') contains a 3 x 2 dataframe #>   3) Tab 'Notes' (sheet type 'notes') contains a 3 x 2 dataframe #>   4) Tab 'Table_1' (sheet type 'tables') contains a 10 x 7 dataframe #>   5) Tab 'Table_2' (sheet type 'tables') contains a 10 x 2 dataframe  # Alternatively, look at the structure str(demo_aftable, max.level = 2) #> Classes ‘aftable’, ‘tbl’ and 'data.frame':\t5 obs. of  7 variables: #>  $ tab_title  : chr  \"Cover\" \"Contents\" \"Notes\" \"Table_1\" ... #>  $ sheet_type : chr  \"cover\" \"contents\" \"notes\" \"tables\" ... #>  $ sheet_title: chr  \"The 'aftables' Demo Workbook\" \"Table of contents\" \"Notes\" \"Table_1: First Example Sheet\" ... #>  $ blank_cells: chr  NA NA NA \"Blank cells indicate that there's no note in that row.\" ... #>  $ source     : chr  NA NA NA \"[The Source Material, 2024.](https://best-practice-and-impact.github.io/aftables/)\" ... #>  $ custom_rows:List of 5 #>   ..$ : chr NA #>   ..$ : chr NA #>   ..$ : chr \"A custom row.\" #>   ..$ : chr  \"First custom row [with a hyperlink.](https://best-practice-and-impact.github.io/aftables/)\" \"Second custom row.\" #>   ..$ : chr \"A custom row.\" #>  $ table      :List of 5 #>   ..$ :List of 3 #>   ..$ :'data.frame':\t3 obs. of  2 variables: #>   ..$ :'data.frame':\t3 obs. of  2 variables: #>   ..$ :'data.frame':\t10 obs. of  7 variables: #>   ..$ :'data.frame':\t10 obs. of  2 variables:"},{"path":"https://best-practice-and-impact.github.io/aftables/reference/tbl_sum.aftable.html","id":null,"dir":"Reference","previous_headings":"","what":"Provide A Succinct Summary Of An 'aftable' Object — tbl_sum.aftable","title":"Provide A Succinct Summary Of An 'aftable' Object — tbl_sum.aftable","text":"brief text description aftable-class object.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/reference/tbl_sum.aftable.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Provide A Succinct Summary Of An 'aftable' Object — tbl_sum.aftable","text":"","code":"# S3 method for class 'aftable' tbl_sum(x, ...)"},{"path":"https://best-practice-and-impact.github.io/aftables/reference/tbl_sum.aftable.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Provide A Succinct Summary Of An 'aftable' Object — tbl_sum.aftable","text":"x aftable-class object summarise. ... arguments pass.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/reference/tbl_sum.aftable.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Provide A Succinct Summary Of An 'aftable' Object — tbl_sum.aftable","text":"Named character vector.","code":""},{"path":"https://best-practice-and-impact.github.io/aftables/reference/tbl_sum.aftable.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Provide A Succinct Summary Of An 'aftable' Object — tbl_sum.aftable","text":"","code":"# Print with description print(demo_aftable) #> # aftable: 5 x 7 #>   tab_title sheet_type sheet_title   blank_cells source custom_rows table        #>   <chr>     <chr>      <chr>         <chr>       <chr>  <list>      <list>       #> 1 Cover     cover      The 'aftable… NA          NA     <chr [1]>   <named list> #> 2 Contents  contents   Table of con… NA          NA     <chr [1]>   <df [3 × 2]> #> 3 Notes     notes      Notes         NA          NA     <chr [1]>   <df [3 × 2]> #> 4 Table_1   tables     Table_1: Fir… Blank cell… [The … <chr [2]>   <df>         #> 5 Table_2   tables     Table_2: Sec… NA          The S… <chr [1]>   <df>          # Print description only (package 'tibble' must be installed) tibble::tbl_sum(demo_aftable) #> aftable  #> \"5 x 7\""},{"path":"https://best-practice-and-impact.github.io/aftables/news/index.html","id":"aftables-100","dir":"Changelog","previous_headings":"","what":"aftables 1.0.0","title":"aftables 1.0.0","text":"Updated package name aftables. Function names updated remove references a11ytables.","code":""}]
