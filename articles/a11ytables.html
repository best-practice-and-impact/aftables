<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="a11ytables">
<title>Introduction to {a11ytables} • a11ytables</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Fira_Code-0.4.7/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Introduction to {a11ytables}">
<meta property="og:description" content="a11ytables">
<meta property="og:image" content="https://co-analysis.github.io/a11ytables/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">a11ytables</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0.9001</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/a11ytables.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/checklist.html">Accessibility guidance checklist</a>
    <a class="dropdown-item" href="../articles/structure.html">Package structure (advanced)</a>
    <a class="dropdown-item" href="../articles/terminology.html">Spreadsheet terminology</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/co-analysis/a11ytables/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to {a11ytables}</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/co-analysis/a11ytables/blob/HEAD/vignettes/a11ytables.Rmd" class="external-link"><code>vignettes/a11ytables.Rmd</code></a></small>
      <div class="d-none name"><code>a11ytables.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="purpose">Purpose<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h3>
<p>This vignette demonstrates how to use {a11ytables} to generate a
spreadsheet output that automatically follows <a href="https://analysisfunction.civilservice.gov.uk/policy-store/releasing-statistics-in-spreadsheets/" class="external-link">best
practice</a>.</p>
</div>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>Install the package <a href="https://github.com/co-analysis/a11ytables" class="external-link">from GitHub</a> using
<a href="https://remotes.r-lib.org/" class="external-link">{remotes}</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span>  <span class="co"># if not already installed</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"co-analysis/a11ytables"</span><span class="op">)</span></span></code></pre></div>
<p>The package depends on <a href="https://ycphs.github.io/openxlsx/" class="external-link">{openxlsx}</a> and <a href="https://pillar.r-lib.org/" class="external-link">{pillar}</a>, which are also installed
with {a11ytables}.</p>
</div>
<div class="section level3">
<h3 id="workflow">Workflow<a class="anchor" aria-label="anchor" href="#workflow"></a>
</h3>
<p>Having installed the {a11ytables} package, there are three steps to
generating a compliant spreadsheet:</p>
<ol style="list-style-type: decimal">
<li>Use <code><a href="../reference/create_a11ytable.html">create_a11ytable()</a></code> to create a special dataframe
(with class ‘a11ytable’) that contains all the content that will go in
your spreadsheet</li>
<li>Pass the output to <code><a href="../reference/generate_workbook.html">generate_workbook()</a></code> to convert the
a11ytable to {openxlsx}‘s ’Workbook’ class, which adds spreadsheet
structure and styles</li>
<li>Pass the output to <code><a href="https://rdrr.io/pkg/openxlsx/man/saveWorkbook.html" class="external-link">openxlsx::saveWorkbook()</a></code> to write
out to an xlsx file (or <code><a href="https://rdrr.io/pkg/openxlsx/man/openXL.html" class="external-link">openxlsx::openXL()</a></code> to open a
temporary copy)</li>
</ol>
<p>The minimal demo below follows these steps using the example data
from <a href="https://rdrr.io/r/datasets/mtcars.html" class="external-link">the classic mtcars
dataset</a>.</p>
<p>You can use the package’s <a href="https://rstudio.github.io/rstudioaddins/" class="external-link">RStudio Addin</a>, which
is installed with {a11ytables}, to insert a pre-filled demo skeleton of
this workflow (RStudio users only).</p>
<div class="section level4">
<h4 id="create-an-a11ytable">1. Create an a11ytable<a class="anchor" aria-label="anchor" href="#create-an-a11ytable"></a>
</h4>
<p>Each argument to <code><a href="../reference/create_a11ytable.html">create_a11ytable()</a></code> provides the
information needed to construct each sheet in the spreadsheet.</p>
<table class="table">
<colgroup>
<col width="19%">
<col width="19%">
<col width="9%">
<col width="19%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th align="left">Argument</th>
<th align="left">Type</th>
<th align="left">Required</th>
<th align="left">Accepted values</th>
<th align="left">Explanation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>tab_titles</code></td>
<td align="left">Character vector</td>
<td align="left">Yes</td>
<td align="left"></td>
<td align="left">The name that will appear on each sheet’s tab in the
output spreadsheet</td>
</tr>
<tr class="even">
<td align="left"><code>sheet_types</code></td>
<td align="left">Character vector</td>
<td align="left">Yes</td>
<td align="left">‘contents’, ‘cover’, ‘notes’, ‘tables’</td>
<td align="left">The kind of information that the sheet holds, which is
needed so that the correct structure and formatting can be applied
later</td>
</tr>
<tr class="odd">
<td align="left"><code>sheet_titles</code></td>
<td align="left">Character vector</td>
<td align="left">Yes</td>
<td align="left"></td>
<td align="left">The main heading of each sheet, which will appear in
cell A1</td>
</tr>
<tr class="even">
<td align="left"><code>blank_cells</code></td>
<td align="left">Character vector</td>
<td align="left">No</td>
<td align="left"></td>
<td align="left">A sentence that explains the reason for any blank cells
in the sheet (if applicable)</td>
</tr>
<tr class="odd">
<td align="left"><code>sources</code></td>
<td align="left">Character vector</td>
<td align="left">No</td>
<td align="left"></td>
<td align="left">A sentence provides the source of the data found in
each table (if applicable, likely only needed for sheets with
<code>sheet_types</code> of ‘table’)</td>
</tr>
<tr class="even">
<td align="left"><code>tables</code></td>
<td align="left">List of dataframes (cover can be a list)</td>
<td align="left">Yes</td>
<td align="left"></td>
<td align="left">The main content for each sheet, expressed as flat (<a href="https://www.jstatsoft.org/article/view/v059i10" class="external-link">probably tidy</a>)
dataframes of rows and columns (though the cover can be a list)</td>
</tr>
</tbody>
</table>
<p>You can read more about these arguments and their requirements in the
function’s help pages, which you can access by running
<code><a href="../reference/create_a11ytable.html">?create_a11ytable</a></code>. See also the <a href="https://co-analysis.github.io/a11ytables/articles/terminology">terminology
vignette</a>, <code><a href="../articles/terminology.html">vignette("terminology", "a11ytables")</a></code>, for
these terms and more.</p>
<div class="section level5">
<h5 id="pre-prepare-tables">Pre-prepare tables<a class="anchor" aria-label="anchor" href="#pre-prepare-tables"></a>
</h5>
<p>Rather than pass a big list of dataframes directly to the
<code>tables</code> argument of <code><a href="../reference/create_a11ytable.html">create_a11ytable()</a></code>, it’s
preferable to prepare them first into their own named objects.</p>
<p>Below are some demo tables that we will later pass to
<code><a href="../reference/create_a11ytable.html">create_a11ytable()</a></code>. I’ve used
<code><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tibble::tribble()</a></code> for human-readable row-by-row dataframe
construction, but you can just use <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame()</a></code> if you
want.</p>
<p>Note that you can use the RStudio Addin ‘Insert table templates using
’tibble’’ and ‘Insert table templates using ’data.frame’’ to insert a
demo skeleton into your R script.</p>
<div class="section level6">
<h6 id="meta-sheets">Meta-sheets<a class="anchor" aria-label="anchor" href="#meta-sheets"></a>
</h6>
<p>The cover can accept either a list or a data.frane (the latter was
the only acceptable input prior to version 0.2.0). We recommend a list
so that you can have multiple rows per section on the cover. This also
means you can dedicate certain rows to be hyperlinks to web URLs or
mailto links that will open an email client. Here’s a demo list for the
contents page (required):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cover_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> </span>
<span>  <span class="st">"Description"</span> <span class="op">=</span> <span class="st">"Aspects of automobile design and performance."</span>,</span>
<span>  <span class="st">"Properties"</span> <span class="op">=</span> <span class="st">"Suppressed values are replaced with the value '[c]'."</span>,</span>
<span>  <span class="st">"Contact"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Contact the mtcars Team."</span>,</span>
<span>    <span class="st">"Telephone 0123456789."</span>,</span>
<span>    <span class="st">"Email us at [invented_email@not_real.com](mailto:invented_email@not_real.com)."</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<details><summary>
Click for an alternative data.frame input for the cover.
</summary><p>Instead of a list, you could provide a data.frame that contains
information for the cover sheet. The limitation with this approach is
that—for each section on the cover sheet—you are restricted to one cell
for the header and one cell for body content. That might not be ideal if
you want to dedicate some cells within a section to be hyperlinks.</p>
<p>Here’s a demo data.frame for the cover that has a column for
sub-headings and a column for the content of each one:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cover_df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span> </span>
<span>  <span class="op">~</span><span class="st">"subsection_title"</span>,  <span class="op">~</span><span class="st">"subsection_content"</span>,</span>
<span>  <span class="st">"Description"</span>, <span class="st">"Aspects of automobile design and performance."</span>,</span>
<span>  <span class="st">"Properties"</span>,  <span class="st">"Suppressed values are replaced with the value '[c]'."</span>,</span>
<span>  <span class="st">"Contact"</span>,     <span class="st">"The mtcars Team, telephone 0123456789."</span></span>
<span><span class="op">)</span></span></code></pre></div>
</details><p>Here’s a demo table for the contents page (required):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contents_df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="st">"Sheet name"</span>, <span class="op">~</span><span class="st">"Sheet title"</span>,</span>
<span>  <span class="st">"Notes"</span>,       <span class="st">"Notes used in this workbook"</span>,</span>
<span>  <span class="st">"Table 1"</span>,     <span class="st">"Car Road Tests (demo)"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>And here’s a demo table for the notes page (not required if there’s
no notes in your tables), which has a column for the note number in the
form ‘[note x]’ and and column for the note itself:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">notes_df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="st">"Note number"</span>, <span class="op">~</span><span class="st">"Note text"</span>,</span>
<span>  <span class="st">"[note 1]"</span>,     <span class="st">"US gallons."</span>,</span>
<span>  <span class="st">"[note 2]"</span>,     <span class="st">"Retained to enable comparisons with previous analyses."</span></span>
<span><span class="op">)</span></span></code></pre></div>
<details><summary>
Click to preview these tables
</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cover_list</span></span>
<span><span class="co"># $Description</span></span>
<span><span class="co"># [1] "Aspects of automobile design and performance."</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># $Properties</span></span>
<span><span class="co"># [1] "Suppressed values are replaced with the value '[c]'."</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># $Contact</span></span>
<span><span class="co"># [1] "Contact the mtcars Team."                                                      </span></span>
<span><span class="co"># [2] "Telephone 0123456789."                                                         </span></span>
<span><span class="co"># [3] "Email us at [invented_email@not_real.com](mailto:invented_email@not_real.com)."</span></span>
<span><span class="va">contents_df</span></span>
<span><span class="co"># <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#   `Sheet name` `Sheet title`              </span></span>
<span><span class="co">#   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                      </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">1</span> Notes        Notes used in this workbook</span></span>
<span><span class="co"># <span style="color: #BCBCBC;">2</span> Table 1      Car Road Tests (demo)</span></span>
<span><span class="va">notes_df</span></span>
<span><span class="co"># <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#   `Note number` `Note text`                                           </span></span>
<span><span class="co">#   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                 </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">1</span> [note 1]      US gallons.                                           </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">2</span> [note 2]      Retained to enable comparisons with previous analyses.</span></span></code></pre></div>
</details>
</div>
<div class="section level6">
<h6 id="statistical-tables">Statistical tables<a class="anchor" aria-label="anchor" href="#statistical-tables"></a>
</h6>
<p>This code generates a demo dataframe that we’re going to pretend is
the statistical data that we want to publish:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stats_df</span> <span class="op">&lt;-</span> <span class="va">mtcars</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span><span class="st">"car"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span>select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"car"</span>, <span class="st">"cyl"</span>, <span class="st">"mpg"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">stats_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Car"</span>,</span>
<span>  <span class="st">"Cylinder count"</span>,</span>
<span>  <span class="st">"Miles per gallon [note 1]"</span>  <span class="co"># notes go in headers, not cells</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">stats_df</span><span class="op">$</span><span class="va">Notes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>  <span class="co"># add 'Notes' column</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"[note 2]"</span>, <span class="fl">2</span><span class="op">)</span>, </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA_character_</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">stats_df</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"[c]"</span>  <span class="co"># suppressed (confidential) data</span></span></code></pre></div>
<details><summary>
Click to preview this table
</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stats_df</span></span>
<span><span class="co">#                 Car Cylinder count Miles per gallon [note 1]    Notes</span></span>
<span><span class="co"># 1         Mazda RX4              6                        21 [note 2]</span></span>
<span><span class="co"># 2     Mazda RX4 Wag              6                        21 [note 2]</span></span>
<span><span class="co"># 3        Datsun 710            [c]                       [c]     &lt;NA&gt;</span></span>
<span><span class="co"># 4    Hornet 4 Drive              6                      21.4     &lt;NA&gt;</span></span>
<span><span class="co"># 5 Hornet Sportabout              8                      18.7     &lt;NA&gt;</span></span>
<span><span class="co"># 6           Valiant              6                      18.1     &lt;NA&gt;</span></span></code></pre></div>
</details><p>See <a href="https://analysisfunction.civilservice.gov.uk/policy-store/releasing-statistics-in-spreadsheets/" class="external-link">the
best practice guidance</a> for more information on how to present data
in these tables.</p>
</div>
</div>
<div class="section level5">
<h5 id="create-a11ytable">Create a11ytable<a class="anchor" aria-label="anchor" href="#create-a11ytable"></a>
</h5>
<p>Now we can construct an a11ytable by passing the required sheet
elements as character vectors with <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code>, or a
<code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code> in the case of the <code>tables</code> argument, to
the <code><a href="../reference/create_a11ytable.html">create_a11ytable()</a></code> function. You can use
<code>NA_character_</code> wherever an element isn’t required.</p>
<p>Note that you can use the RStudio Addin ‘Insert ’a11ytable’ Template’
to insert a demo skeleton into your R script.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_a11ytable</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">a11ytables</span><span class="fu">::</span><span class="fu"><a href="../reference/create_a11ytable.html">create_a11ytable</a></span><span class="op">(</span></span>
<span>    tab_titles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Cover"</span>,</span>
<span>      <span class="st">"Contents"</span>,</span>
<span>      <span class="st">"Notes"</span>,</span>
<span>      <span class="st">"Table 1"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    sheet_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"cover"</span>,</span>
<span>      <span class="st">"contents"</span>,</span>
<span>      <span class="st">"notes"</span>,</span>
<span>      <span class="st">"tables"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    sheet_titles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"The 'mtcars' Demo Datset"</span>,</span>
<span>      <span class="st">"Table of contents"</span>,</span>
<span>      <span class="st">"Notes"</span>,</span>
<span>      <span class="st">"Table 1: Car Road Tests"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    blank_cells <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="cn">NA_character_</span>,</span>
<span>      <span class="cn">NA_character_</span>,</span>
<span>      <span class="cn">NA_character_</span>, </span>
<span>      <span class="st">"Blank cells indicate that there's no note in that row"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    sources <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="cn">NA_character_</span>,</span>
<span>      <span class="cn">NA_character_</span>,</span>
<span>      <span class="cn">NA_character_</span>, </span>
<span>      <span class="st">"Motor Trend (1974)"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    tables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="va">cover_list</span>,</span>
<span>      <span class="va">contents_df</span>,</span>
<span>      <span class="va">notes_df</span>,</span>
<span>      <span class="va">stats_df</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co"># Warning: These tab_titles have been cleaned automatically: Table 1 (now</span></span>
<span><span class="co"># Table_1).</span></span></code></pre></div>
<p>The function will return errors or warnings if anything is missing or
seems odd. For example, we were warned that a value we supplied to
<code>tab_title</code> had to be cleaned from ‘Table 1’ to ‘Table_1’,
since blank spaces are not allowed.</p>
<p>Here’s a preview of the object that was created:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_a11ytable</span></span>
<span><span class="co"># <span style="color: #949494;"># a11ytable: 4 x 6</span></span></span>
<span><span class="co">#   tab_title sheet_type sheet_title              blank_cells  source table       </span></span>
<span><span class="co">#   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>      </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">1</span> Cover     cover      The 'mtcars' Demo Datset <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span>     <span style="color: #949494;">&lt;named list&gt;</span></span></span>
<span><span class="co"># <span style="color: #BCBCBC;">2</span> Contents  contents   Table of contents        <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span>     <span style="color: #949494;">&lt;tibble&gt;</span>    </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">3</span> Notes     notes      Notes                    <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span>     <span style="color: #949494;">&lt;tibble&gt;</span>    </span></span>
<span><span class="co"># <span style="color: #BCBCBC;">4</span> Table_1   tables     Table 1: Car Road Tests  Blank cells… Motor… <span style="color: #949494;">&lt;df [6 × 4]&gt;</span></span></span></code></pre></div>
<p>You can immediately tell that this is an a11ytable because it’s the
first word that’s printed with the output.</p>
<p>So our a11ytable is basically just a table with one row per sheet and
one column per sheet element. In fact, it has class ‘data.frame’/‘tbl’
along with ‘a11ytable’. For convenience, you can also check for the
a11ytable class with <code><a href="../reference/as_a11ytable.html">is_a11ytable()</a></code>.</p>
<p>Note that <code><a href="../reference/create_a11ytable.html">create_a11ytable()</a></code> is the preferred method for
generating a11ytable-class objects, but it’s also possible to convert a
correctly-formatted, pre-built data.frame or tibble directly to an
a11ytable with <code><a href="../reference/as_a11ytable.html">as_a11ytable()</a></code>. You can try this using the
<code>mtcars_df</code> data.frame that’s provided with {a11ytables},
which is a specially-prepared subset of <a href="https://rdrr.io/r/datasets/mtcars.html" class="external-link">the mtcars
dataset</a>.</p>
</div>
</div>
<div class="section level4">
<h4 id="convert-to-a-workbook">2. Convert to a workbook<a class="anchor" aria-label="anchor" href="#convert-to-a-workbook"></a>
</h4>
<p>We can use <code><a href="../reference/generate_workbook.html">generate_workbook()</a></code> to convert our a11ytable
to an <a href="https://ycphs.github.io/openxlsx/" class="external-link">{openxlsx}</a>
Workbook-class object.</p>
<p>This type of object adds information from each row of our a11ytable
into separate sheets and applies other relevant structure, mark-up and
styles for compliance with <a href="https://analysisfunction.civilservice.gov.uk/policy-store/releasing-statistics-in-spreadsheets/" class="external-link">the
best practice guidance</a>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_wb</span> <span class="op">&lt;-</span> <span class="fu">a11ytables</span><span class="fu">::</span><span class="fu"><a href="../reference/generate_workbook.html">generate_workbook</a></span><span class="op">(</span><span class="va">my_a11ytable</span><span class="op">)</span></span></code></pre></div>
<details><summary>
Click for a preview of the Workbook object
</summary><p>The print method for a Workbook-class object is fairly limited, but
you can see an overview of our named sheets and some of the custom
styling.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_wb</span></span>
<span><span class="co"># A Workbook object.</span></span>
<span><span class="co">#  </span></span>
<span><span class="co"># Worksheets:</span></span>
<span><span class="co">#  Sheet 1: "Cover"</span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#   Custom row heights (row: height)</span></span>
<span><span class="co">#    2: 34, 4: 34, 6: 34 </span></span>
<span><span class="co">#   Custom column widths (column: width)</span></span>
<span><span class="co">#     1: 72 </span></span>
<span><span class="co">#  </span></span>
<span><span class="co"># </span></span>
<span><span class="co">#  Sheet 2: "Contents"</span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#   Custom column widths (column: width)</span></span>
<span><span class="co">#     1: 16, 2: 56 </span></span>
<span><span class="co">#  </span></span>
<span><span class="co"># </span></span>
<span><span class="co">#  Sheet 3: "Notes"</span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#   Custom column widths (column: width)</span></span>
<span><span class="co">#     1: 16, 2: 56 </span></span>
<span><span class="co">#  </span></span>
<span><span class="co"># </span></span>
<span><span class="co">#  Sheet 4: "Table_1"</span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#   Custom column widths (column: width)</span></span>
<span><span class="co">#     1: 16, 2: 16, 3: 16, 4: 16 </span></span>
<span><span class="co">#  </span></span>
<span><span class="co"># </span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  Worksheet write order: 1, 2, 3, 4</span></span>
<span><span class="co">#  Active Sheet 1: "Cover" </span></span>
<span><span class="co">#   Position: 1</span></span></code></pre></div>
</details>
</div>
<div class="section level4">
<h4 id="write-to-file">3. Write to file<a class="anchor" aria-label="anchor" href="#write-to-file"></a>
</h4>
<p>Finally, you can use <a href="https://ycphs.github.io/openxlsx/reference/saveWorkbook.html" class="external-link">the
<code>saveWorkbook()</code> function from {openxlsx}</a> to write your
workbook object to an xlsx file (set the filename argument to a location
suitable for your work).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/saveWorkbook.html" class="external-link">saveWorkbook</a></span><span class="op">(</span><span class="va">my_wb</span>, <span class="st">"publication.xlsx"</span><span class="op">)</span></span></code></pre></div>
<p>You could also open a temporary copy of the workbook with
<code><a href="https://rdrr.io/pkg/openxlsx/man/openXL.html" class="external-link">openxlsx::openXL()</a></code>, which is convenient during the
development process.</p>
<div class="section level5">
<h5 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a>
</h5>
<p>The content of the output spreadsheet will look like this:</p>
<div class="figure">
<p><img src="../reference/figures/vignette-workbook.gif" alt="Gif of a simple Excel workbook created using the a11ytables package, revealing tabs for cover, contents, notes and a table." width="100%"></p>
</div>
<p>You’ll notice that various best-practice formatting (e.g. Arial size
12 font for body text) and mark-up (e.g. tables, donated by a marker in
the lower-right corner of the lower-right cell of each one) have been
applied throughout.</p>
<p>Note also that two ‘pre-table’ meta-elements were created
automatically in the sheets that contain statistical tables, which you
didn’t need to supply to <code><a href="../reference/create_a11ytable.html">create_a11ytable()</a></code>: (1) the number
of tables and (2) the presence of notes.</p>
</div>
<div class="section level5">
<h5 id="final-tweaks">Final tweaks<a class="anchor" aria-label="anchor" href="#final-tweaks"></a>
</h5>
<p>It’s your responsibility to check and amend the output from
{a11ytables} to ensure it meets user’s accessibility needs.</p>
<p>You can apply some final tweaks to the output xlsx file if the
defaults don’t quite meet your requirements (e.g. some column widths),
though it’s advisable to keep changes to a minimum for reproducibility
purposes and because you may undo some of the compliant structuring and
formatting that {a11ytables} provides.</p>
<p>At time of writing (v0.2.0) you might want to address manually some
other <a href="https://analysisfunction.civilservice.gov.uk/policy-store/releasing-statistics-in-spreadsheets/" class="external-link">accessibility
requirements</a> that are not yet covered by the package:</p>
<ol style="list-style-type: decimal">
<li>Fill in the document properties, which you are likely to find under
‘File’ then ‘Properties’ in your spreadsheet software</li>
<li>Convert text to hyperlinks, where required</li>
<li>Convert to an ODS file rather than the proprietary xlsx format</li>
<li>Various number-formatting issues, like padding decimal places with
zeroes</li>
</ol>
<p>Please <a href="https://github.com/co-analysis/a11ytables/issues" class="external-link">see
the issues on GitHub</a>; we’re trying to address a number of these
limitations.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="contribute">Contribute<a class="anchor" aria-label="anchor" href="#contribute"></a>
</h2>
<p>To contribute, please add <a href="https://github.com/co-analysis/a11ytables/issues" class="external-link">an issue</a> or
<a href="https://github.com/co-analysis/a11ytables/pulls" class="external-link">a pull
request</a> after reading <a href="https://github.com/co-analysis/a11ytables/blob/main/CODE_OF_CONDUCT.md" class="external-link">the
code of conduct</a> and <a href="https://github.com/co-analysis/a11ytables/blob/main/.github/CONTRIBUTING.md" class="external-link">contributing</a>
guidance.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>© Crown Copyright, 2023, Cabinet Office</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
