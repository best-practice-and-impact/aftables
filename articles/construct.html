<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Construct an a11ytable • a11ytables</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Construct an a11ytable">
<meta property="og:description" content="a11ytables">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">a11ytables</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.90010</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/accessibility.html">Accessibility guidance checklist</a>
    </li>
    <li>
      <a href="../articles/construct.html">Construct an a11ytable</a>
    </li>
    <li>
      <a href="../articles/quickstart.html">Get started</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/co-analysis/a11ytables/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="construct_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Construct an a11ytable</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/co-analysis/a11ytables/blob/HEAD/vignettes/construct.Rmd" class="external-link"><code>vignettes/construct.Rmd</code></a></small>
      <div class="hidden name"><code>construct.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="purpose">Purpose<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h2>
<p>The purpose of this vignette is to demonstrate how to create an a11ytable-class object, with a little more depth than <a href="https://co-analysis.github.io/a11ytables/articles/quickstart.html" class="external-link">the quickstart guide</a>.</p>
</div>
<div class="section level2">
<h2 id="approaches">Approaches<a class="anchor" aria-label="anchor" href="#approaches"></a>
</h2>
<p>You need to create an a11ytable before it’s converted to an {openxlsx} Workbook-class object and then output as an Excel workbook (xlsx).</p>
<p>There are two approaches to constructing an a11ytable-class object:</p>
<ol style="list-style-type: decimal">
<li>Pass arguments directly to <code><a href="../reference/new_a11ytable.html">new_a11ytable()</a></code>
</li>
<li>Create a data.frame-class object for conversion to a11ytable-class with <code><a href="../reference/as_a11ytable.html">as_a11ytable()</a></code>.</li>
</ol>
</div>
<div class="section level2">
<h2 id="workbook-nomenclature">Workbook nomenclature<a class="anchor" aria-label="anchor" href="#workbook-nomenclature"></a>
</h2>
<p>We should start by reviewing specific terms used to refer to the structure of a workbook.</p>
<p>An output <em>workbook</em> contains <em>tabs</em> that have <em>sheets</em> in them. Each tab has a unique <em>tab title</em>.</p>
<p>Sheets can be one of four <em>types</em> that dictate the layout and content of a given sheet:</p>
<ul>
<li>a <em>cover</em> sheet (required) contains the title of the workbook and miscellaneous details about the workbook, the data it contains and its producers</li>
<li>a <em>contents</em> sheet (required) contains a table showing the contents of the workbook at a glance</li>
<li>a <em>notes</em> sheet (if applicable) contains a table with a lookup of the note codes and explanations</li>
<li>one or more <em>tables</em> sheets (required) that contain statistical tables</li>
</ul>
<p>Sheets are composed of <em>elements</em>:</p>
<ul>
<li>a <em>sheet title</em> to be displayed at the top of the sheet (user-provided)</li>
<li>a count of the number of tables in the sheet (auto-generated sentence)</li>
<li>a <em>source</em> to explain where the data come from (auto-generated based on user input)</li>
<li>a warning that the sheet contains notes (auto-generated based on the presence of notes)</li>
<li>a <em>table</em> that contains information as rows and columns and has a <em>table name</em> (both are user-provided, latter should be unique per table)</li>
</ul>
<p>The <code><a href="../reference/new_a11ytable.html">new_a11ytable()</a></code> function takes these elements as arguments to build an a11ytable-class object for you. For example, you pass a vector of tab titles to the <code>tab_titles</code> argument and a list of data.frames to the <code>table</code> argument.</p>
<p>Alternatively, you can construct your own data.frame with columns for each of these elements and coerce it to a11ytable-class using <code><a href="../reference/as_a11ytable.html">as_a11ytable()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>To demonstrate the paths to creating an a11ytable, we can:</p>
<ol style="list-style-type: decimal">
<li>Prepare a table of information for each sheet of the workbook</li>
<li>Create an a11ytables-class object by either:
<ol style="list-style-type: lower-alpha">
<li>passing data (including the data.frames mentioned above) as arguments to <code><a href="../reference/new_a11ytable.html">new_a11ytable()</a></code>
</li>
<li>building your own data.frame and coercing with <code><a href="../reference/as_a11ytable.html">as_a11ytable()</a></code>
</li>
</ol>
</li>
</ol>
<p>Of course, we start by attaching the {a11ytables} package. I’m going to use {tibble} to construct tables, but you could use base R functions.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/co-analysis/a11ytables" class="external-link">a11ytables</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></code></pre></div>
<p>The example below uses the ‘mtcars’ dataset as the basis for an imaginary publication.</p>
<div class="section level3">
<h3 id="prepare-tables">1. Prepare tables<a class="anchor" aria-label="anchor" href="#prepare-tables"></a>
</h3>
<p>Each a11ytable sheet contains a tidy dataframe of information. Let’s prepare these first.</p>
<p>For sheet type ‘cover’ (required), the table should contain a row per subsection with columns for the title and body text of each subsection. This will be arranged in the final output as a single column, alternating from title to body, with appropriate styling.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span>

<span class="va">cover_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span>
  <span class="op">~</span><span class="st">"Subsection title"</span>, <span class="op">~</span><span class="st">"Subsection body"</span>,
  <span class="st">"Description"</span>, <span class="st">"The data was extracted from the 1974 Motor Trend US magazine, and comprises fuel consumption and 10 aspects of automobile design and performance for 32 automobiles (1973–74 models)"</span>,
  <span class="st">"Format"</span>, <span class="st">"A data frame with 32 observations on 11 (numeric) variables."</span>
<span class="op">)</span></code></pre></div>
<p>For sheet type ‘contents’ (required), the table should have a row per workbook sheet with columns for the tab title and the sheet title.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">contents_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span>
  <span class="op">~</span><span class="st">"Sheet name"</span>, <span class="op">~</span><span class="st">"Sheet title"</span>,
  <span class="st">"Notes"</span>, <span class="st">"Notes"</span>,
  <span class="st">"Table 1"</span>, <span class="st">"Motor Trend Car Road Tests"</span>
<span class="op">)</span></code></pre></div>
<p>For sheet type ‘notes’ (not required if there aren’t any notes), the table should have a row per note in your workbook, with columns for the note number and note text.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">notes_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span>
  <span class="op">~</span><span class="st">"Note number"</span>, <span class="op">~</span><span class="st">"Note text"</span>,
  <span class="st">"[c]"</span>, <span class="st">"Confidential: suppressed."</span>,
  <span class="st">"[z]"</span>, <span class="st">"Not applicable."</span>,
  <span class="st">"[1]"</span>, <span class="st">"Hocking [original transcriber]'s noncrucial coding of the Mazda's rotary engine as a straight six-cylinder engine and the Porsche's flat engine as a V engine, as well as the inclusion of the diesel Mercedes 240D, have been retained to enable direct comparisons to be made with previous analyses."</span>,
  <span class="st">"[2]"</span>, <span class="st">"Test note."</span>,
  <span class="st">"[3]"</span>, <span class="st">"Test note."</span>
<span class="op">)</span></code></pre></div>
<p>For sheet type ‘tables’ (required), the table should have whatever rows and columns are in the statistical table being published. It should be a tidy, ‘flat’ table with one row of headers and no empty rows or columns.</p>
<p>Below is a test example that builds on the ‘mtcars’ dataset (note that this example is provided in this package as the in-built data set <code>mtcars_df</code>).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Select mtcars columns</span>
<span class="va">cars_df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="st">"car"</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span>select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"car"</span>, <span class="st">"mpg"</span>, <span class="st">"cyl"</span>, <span class="st">"disp"</span>, <span class="st">"hp"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Add suppression examples</span>
<span class="va">cars_df</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"mpg"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"[c]"</span> <span class="co"># single</span>
<span class="va">cars_df</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">cars_df</span><span class="op">)</span> , <span class="st">"cyl"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"[c]"</span>  <span class="co"># multi (all but one suppressed)</span>
<span class="va">cars_df</span><span class="op">[</span>, <span class="st">"disp"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"[c]"</span>  <span class="co"># all suppressed</span>

<span class="co"># Add notes column example</span>
<span class="va">notes_cars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mazda RX4"</span>, <span class="st">"Mazda RX4 Wag"</span>, <span class="st">"Porsche 914-2"</span>, <span class="st">"Merc 240D"</span><span class="op">)</span>
<span class="va">cars_df</span><span class="op">[[</span><span class="st">"Notes"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">cars_df</span><span class="op">[[</span><span class="st">"car"</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">notes_cars</span>, <span class="st">"[1]"</span>, <span class="st">"[z]"</span><span class="op">)</span>

<span class="co"># Provide better names</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cars_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
  <span class="st">"Car"</span>,
  <span class="st">"Miles per gallon [2]"</span>,
  <span class="st">"Cylinders [2, 3]"</span>,
  <span class="st">"Displacement [note 2]"</span>,
  <span class="st">"Horsepower [note]"</span>,
  <span class="st">"Notes"</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">cars_df</span><span class="op">)</span>
<span class="co"># 'data.frame': 32 obs. of  6 variables:</span>
<span class="co">#  $ Car                  : chr  "Mazda RX4" "Mazda RX4 Wag" "Datsun 710" "Hornet 4 Drive" ...</span>
<span class="co">#  $ Miles per gallon [2] : chr  "[c]" "21" "22.8" "21.4" ...</span>
<span class="co">#  $ Cylinders [2, 3]     : chr  "6" "[c]" "[c]" "[c]" ...</span>
<span class="co">#  $ Displacement [note 2]: chr  "[c]" "[c]" "[c]" "[c]" ...</span>
<span class="co">#  $ Horsepower [note]    : num  110 110 93 110 175 105 245 62 95 123 ...</span>
<span class="co">#  $ Notes                : chr  "[1]" "[1]" "[z]" "[z]" ...</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="a--new-a11ytable-with-new_a11ytable">2a. New a11ytable with <code>new_a11ytable()</code><a class="anchor" aria-label="anchor" href="#a--new-a11ytable-with-new_a11ytable"></a>
</h3>
<p>The first option for creating the a11ytable-class object is to create it ‘from new’ by passing arguments about sheet elements to the <code><a href="../reference/new_a11ytable.html">new_a11ytable()</a></code> function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a11ytable_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_a11ytable.html">new_a11ytable</a></span><span class="op">(</span>
  tab_titles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cover"</span>, <span class="st">"Contents"</span>, <span class="st">"Notes"</span>, <span class="st">"Table 1"</span><span class="op">)</span>,
  sheet_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cover"</span>, <span class="st">"contents"</span>, <span class="st">"notes"</span>, <span class="st">"tables"</span><span class="op">)</span>,
  sheet_titles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
    <span class="st">"The mtcars demo datset: 'Motor Trend Car Road Tests'"</span>,
    <span class="st">"Table of contents"</span>,
    <span class="st">"Notes"</span>,
    <span class="st">"Motor Trend Car Road Tests"</span>
  <span class="op">)</span>,
  sources <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
    <span class="cn">NA_character_</span>,
    <span class="cn">NA_character_</span>,
    <span class="cn">NA_character_</span>, 
    <span class="st">"Motor Trend (1974)"</span>
  <span class="op">)</span>,
  table_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
    <span class="st">"cover_sheet"</span>,
    <span class="st">"table_of_contents"</span>,
    <span class="st">"notes_table"</span>,
    <span class="st">"demographic_benchmarks"</span>
  <span class="op">)</span>,
  tables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    <span class="va">cover_df</span>,
    <span class="va">contents_df</span>,
    <span class="va">notes_df</span>,
    <span class="va">cars_df</span>
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>You can confirm the class with <code><a href="../reference/as_a11ytable.html">is_a11ytable()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/as_a11ytable.html">is_a11ytable</a></span><span class="op">(</span><span class="va">a11ytable_new</span><span class="op">)</span>
<span class="co"># [1] TRUE</span></code></pre></div>
<p>Success.</p>
</div>
<div class="section level3">
<h3 id="b--coerce-an-a11ytable-with-as_a11ytable">2b. Coerce an a11ytable with <code>as_a11ytable()</code><a class="anchor" aria-label="anchor" href="#b--coerce-an-a11ytable-with-as_a11ytable"></a>
</h3>
<p>The second option is to create a data.frame with the appropriate variables and content and coerce it to a11ytable class with <code><a href="../reference/as_a11ytable.html">as_a11ytable()</a></code> (a11ytable objects are just a type of data.frame with an additional class, after all).</p>
<p>Starting with a data.frame of your own construction is a more flexible way of creating an a11ytable, if you know what you’re doing. There are validation checks within the function to catch anything that doesn’t look right, resulting in errors or warnings.</p>
<p>Again, we can use the mtcars example from the section above (also available as the built-in dataset <code>mtcars_df</code>).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">content_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>
  tab_title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cover"</span>, <span class="st">"Contents"</span>, <span class="st">"Notes"</span>, <span class="st">"Table 1"</span><span class="op">)</span>,
  sheet_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cover"</span>, <span class="st">"contents"</span>, <span class="st">"notes"</span>, <span class="st">"tables"</span><span class="op">)</span>,
  sheet_title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
    <span class="st">"The mtcars demo dataset: 'Motor Trend Car Road Tests'"</span>,
    <span class="st">"Table of contents"</span>,
    <span class="st">"Notes"</span>,
    <span class="st">"Motor Trend Car Road Tests"</span>
  <span class="op">)</span>,
  source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
    <span class="cn">NA_character_</span>, <span class="cn">NA_character_</span>, <span class="cn">NA_character_</span>, 
    <span class="st">"Motor Trend (1974)"</span>
  <span class="op">)</span>,
  table_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
    <span class="st">"cover_sheet"</span>,
    <span class="st">"table_of_contents"</span>,
    <span class="st">"notes_table"</span>,
    <span class="st">"demographic_benchmarks"</span>
  <span class="op">)</span>,
  table <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
    <span class="va">cover_df</span>,
    <span class="va">contents_df</span>,
    <span class="va">notes_df</span>,
    <span class="va">cars_df</span>
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>This data.frame object can be passed directly into the <code><a href="../reference/as_a11ytable.html">as_a11ytable()</a></code> function to add the a11ytable class, which again you can test with <code><a href="../reference/as_a11ytable.html">is_a11ytable()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a11ytable_coerced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_a11ytable.html">as_a11ytable</a></span><span class="op">(</span><span class="va">content_df</span><span class="op">)</span>
<span class="fu"><a href="../reference/as_a11ytable.html">is_a11ytable</a></span><span class="op">(</span><span class="va">a11ytable_coerced</span><span class="op">)</span>
<span class="co"># [1] TRUE</span></code></pre></div>
<p>Success.</p>
</div>
</div>
<div class="section level2">
<h2 id="validation">Validation<a class="anchor" aria-label="anchor" href="#validation"></a>
</h2>
<p>You’ll receive an error and the a11ytable will fail to be built if you’re missing crucial content, or the information you provide can’t be used to build a data.frame object (e.g. you supply an unequal number of elements to each argument of <code><a href="../reference/new_a11ytable.html">new_a11ytable()</a></code>).</p>
<p>You’ll get a warning if you do something that needs tidying up. For example, in your tables you may have marked some variables with note markers, but forgot to add the note text to the table in your notes sheet. You might see this if you have notes ‘[3]’ and ‘[4]’ marked in your table, but not explained in your notes sheet:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Warning message:</span>
<span class="co"># Some notes are in the notes sheets (3, 4) but are missing from the tables. </span></code></pre></div>
<p>{a11ytables} is forgiving with these types of issues, allowing you to develop your code more easily. Of course, it’s the responsibility of the user to respond to these warnings.</p>
</div>
<div class="section level2">
<h2 id="next-steps">Next steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h2>
<p>Regardless of whether <code><a href="../reference/new_a11ytable.html">new_a11ytable()</a></code> or <code><a href="../reference/as_a11ytable.html">is_a11ytable()</a></code> was used, the a11ytable-class output can be passed to <code><a href="../reference/create_a11y_wb.html">create_a11y_wb()</a></code> to convert it to Workbook-class, before being written with <code><a href="https://rdrr.io/pkg/openxlsx/man/saveWorkbook.html" class="external-link">openxlsx::saveWorkbook()</a></code> or opened as a temporary file with <code><a href="https://rdrr.io/pkg/openxlsx/man/openXL.html" class="external-link">openxlsx::openXL()</a></code>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Matt Dray.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
