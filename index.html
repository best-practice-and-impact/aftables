<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Create Spreadsheet Publications Following GSS Best Practice • a11ytables</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Create Spreadsheet Publications Following GSS Best Practice">
<meta property="og:description" content="Generate spreadsheet publications for official release by UK
    government following best practice guidance from the UKs Government 
    Statistical Service (GSS), with a focus on accessibility for all users.
    Based on {openxlsx}. See also the Python package gptables' by the Best 
    Practice and Impact Division.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">a11ytables</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/co-analysis/a11ytables/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="a11ytables" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#a11ytables" class="anchor"></a>{a11ytables}</h1></div>
<!-- badges: start -->

<div id="purpose" class="section level2">
<h2 class="hasAnchor">
<a href="#purpose" class="anchor"></a>Purpose</h2>
<p>{a11ytables} is a work-in-progress R package built around <a href="https://ycphs.github.io/openxlsx/">{openxlsx}</a> that aims to comply with the latest guidance (June 2021) on <a href="https://gss.civilservice.gov.uk/policy-store/releasing-statistics-in-spreadsheets/">releasing statistics in spreadsheets</a> from the <a href="https://github.com/best-practice-and-impact?language=html">Best Practice and Impact Division</a> (BPID) of the UK’s <a href="https://gss.civilservice.gov.uk/">Government Statistical Service</a>.</p>
<p>Features are in-development and opinionated. Certain things may not work as you intend and you may need to tweak your final workbook object after creation. The onus is on the user to check their work. See <a href="https://co-analysis.github.io/a11ytables/">the package website</a> for online documentation.</p>
</div>
<div id="similar-projects" class="section level2">
<h2 class="hasAnchor">
<a href="#similar-projects" class="anchor"></a>Similar projects</h2>
<p>BPID have themselves released <a href="https://github.com/best-practice-and-impact/gptables">a Python package called ‘gptables’</a> to help users produce such spreadsheets, but it’s based on a prior version of the guidance. <a href="https://github.com/best-practice-and-impact/gptables/issues/145">That package will be updated</a>, but there’s a gap for this functionality—and for a dedicated R package—at the time of writing (August 2021).</p>
<p>{a11ytables} is being developed with specific statistical releases in mind, but the goal is to generalise it and perhaps have some functionality absorbed into the development of <a href="https://github.com/best-practice-and-impact/gptables">gptables</a> in some way.</p>
</div>
<div id="install-and-use" class="section level2">
<h2 class="hasAnchor">
<a href="#install-and-use" class="anchor"></a>Install and use</h2>
<p>You can install {a11ytables} from GitHub. using {remotes}.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"co-analysis/a11ytables"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/co-analysis/a11ytables">a11ytables</a></span><span class="op">)</span></code></pre></div>
<p>The package depends on {openxlsx} for constructing workbooks and {purrr} for readable function iteration. Both are imported with {a11ytables}. The {magrittr} pipe (<code><a href="reference/%&gt;%.html">%&gt;%</a></code>) is exported for convenience.</p>
<p>At time of writing, you would do something like this to generate a publication:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">example_wb</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/createWorkbook.html">createWorkbook</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="reference/add_tabs.html">add_tabs</a></span><span class="op">(</span><span class="va">lfs_tables</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="reference/add_cover.html">add_cover</a></span><span class="op">(</span><span class="va">lfs_tables</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="reference/add_contents.html">add_contents</a></span><span class="op">(</span><span class="va">lfs_tables</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="reference/add_notes.html">add_notes</a></span><span class="op">(</span><span class="va">lfs_tables</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="reference/add_tables.html">add_tables</a></span><span class="op">(</span><span class="va">lfs_tables</span>, table_name <span class="op">=</span> <span class="st">"Labour_market_summary_for_16_and_over"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="reference/add_tables.html">add_tables</a></span><span class="op">(</span><span class="va">lfs_tables</span>, table_name <span class="op">=</span> <span class="st">"Labour_market_activity_groups_16_and_over"</span><span class="op">)</span>

<span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/openXL.html">openXL</a></span><span class="op">(</span><span class="va">example_wb</span><span class="op">)</span>  <span class="co"># optionally open temp copy</span>
<span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/saveWorkbook.html">saveWorkbook</a></span><span class="op">(</span><span class="va">example_wb</span>, <span class="st">"publication.xlsx"</span><span class="op">)</span></code></pre></div>
<p>In other words, you create an {openxlsx} Workbook-class object, then add each sheet one by one with {allytables} functions. An important user input is the information required to populate each sheet, which must be provided in a particular format. The package’s built-in <code>lfs_tables</code> data set provides an example (see the next section for a preview).</p>
</div>
<div id="concept" class="section level2">
<h2 class="hasAnchor">
<a href="#concept" class="anchor"></a>Concept</h2>
<p>A <em>workbook</em> is made of <em>sheets</em>. There are two types of sheet: <em>meta</em> (<em>cover</em>, <em>contents</em> and optional <em>notes</em>) and <em>tables</em>.</p>
<p>Sheets are built from <em>elements</em>, which includes the title, an announcement on the number of tables/presence of notes, an announcement of the source, and the tables themselves</p>
<p>You can build each <em>sheet</em> type using the <code>add_*()</code> functions. Each one creates a sheet that is inserted into a named {openxlsx} Workbook-class object using data from a user-supplied <em>contents</em> object.</p>
<p>The <em>contents</em> object has a very strict format. It’s a data.frame/tibble-class object that contains the information needed to construct each sheet. The columns and certain contents must follow particular requirements.</p>
<p>The package contains a dummy dataset with the correct format; it’s a truncated version of the example provided in <a href="https://gss.civilservice.gov.uk/policy-store/releasing-statistics-in-spreadsheets/">the guidance</a>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="va">lfs_tables</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 8</span>
<span class="co">#&gt;   tab_title sheet_type sheet_title source subtable_num subtable_title table_name</span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;        &lt;chr&gt;          &lt;chr&gt;     </span>
<span class="co">#&gt; 1 cover     meta       Labour mar… &lt;NA&gt;   &lt;NA&gt;         &lt;NA&gt;           Cover_con…</span>
<span class="co">#&gt; 2 contents  meta       Table of c… &lt;NA&gt;   &lt;NA&gt;         &lt;NA&gt;           Table_of_…</span>
<span class="co">#&gt; 3 notes     meta       Notes       &lt;NA&gt;   &lt;NA&gt;         &lt;NA&gt;           Notes_tab…</span>
<span class="co">#&gt; 4 1a        tables     Number and… Labou… &lt;NA&gt;         &lt;NA&gt;           Labour_ma…</span>
<span class="co">#&gt; 5 2         tables     Number and… Labou… a            Number and pe… Labour_ma…</span>
<span class="co">#&gt; 6 2         tables     Number and… Labou… b            Number and pe… Labour_ma…</span>
<span class="co">#&gt; # … with 1 more variable: table &lt;list&gt;</span></code></pre></div>
<p>Each row is a table to insert into the output. <code>tab_title</code> is needed to name the tabs in the workbook; <code>sheet_title</code> is inserted as the first sheet <em>element</em>; if there’s more than one table in a sheet (try to avoid this), you need a <code>subtable_num</code> and <code>subtable_title</code>; a <code>table_name</code> which is a ‘hidden’ title applied to the marked-up cells of table; and <code>table</code>, which is a listcol containing the data as a rectangular data.frame/tibble-class object. For example:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lfs_tables</span> <span class="op">%&gt;%</span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">filter</span><span class="op">(</span><span class="va">tab_title</span> <span class="op">==</span> <span class="st">"1a"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">pull</span><span class="op">(</span><span class="st">"table"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">`[[`</span><span class="op">(</span><span class="va">.</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span>  <span class="co"># extract from list form</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">select</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>  <span class="co"># first few cols</span>
<span class="co">#&gt; # A tibble: 6 × 3</span>
<span class="co">#&gt;   `Time period and dataset code row` `Number of people (… `Economically active\…</span>
<span class="co">#&gt;   &lt;chr&gt;                                             &lt;dbl&gt;                  &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Mar to May 2020                               53534074.              34127374.</span>
<span class="co">#&gt; 2 Apr to Jun 2020                               53556401.              34051489.</span>
<span class="co">#&gt; 3 May to Jul 2020                               53579793.              34116254.</span>
<span class="co">#&gt; 4 Jun to Aug 2020                               53603157.              34112847.</span>
<span class="co">#&gt; 5 Jul to Sep 2020                               53626130               34130192.</span>
<span class="co">#&gt; 6 Aug to Oct 2020                               53649283               34213332.</span></code></pre></div>
</div>
<div id="code-of-conduct" class="section level2">
<h2 class="hasAnchor">
<a href="#code-of-conduct" class="anchor"></a>Code of Conduct</h2>
<p>Please note that the {a11ytables} project is released with a <a href="https://contributor-covenant.org/version/2/0/CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
<p>Cabinet Office users, please adhere to <a href="https://docs.google.com/document/d/1CuNgKla1BwSVOmGkPmsq0S-OM4emP-iXrgnm7EeILWM/edit?usp=sharing">the co-analysis Git and GitHub code of conduct and usage policy</a>.</p>
<p>Please <a href="https://github.com/co-analysis/csstatsbulletin/issues">file an issue</a> where possible and provide meaningful commentary in any commits and pull requests.</p>
</div>
<div id="copyright" class="section level2">
<h2 class="hasAnchor">
<a href="#copyright" class="anchor"></a>Copyright</h2>
<p>Copyright (c) 2021 Crown Copyright (Cabinet Office).</p>
<p>The code in this repository is released under the MIT license as per <a href="https://gds-way.cloudapps.digital/manuals/licensing.html#use-mit">The GDS Way</a>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/co-analysis/a11ytables/">https://​github.com/​co-analysis/​a11ytables/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/co-analysis/a11ytables/issues">https://​github.com/​co-analysis/​a11ytables/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="community">
<h2>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Matt Dray <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.repostatus.org/#wip"><img src="https://www.repostatus.org/badges/latest/wip.svg" alt="Project Status: WIP – Initial development is in progress, but there has not yet been a stable, usable release suitable for the public."></a></li>
<li><a href="https://CRAN.R-project.org/package=a11ytables"><img src="https://www.r-pkg.org/badges/version/a11ytables" alt="CRAN status"></a></li>
<li><a href="https://github.com/co-analysis/a11ytables/actions"><img src="https://github.com/co-analysis/a11ytables/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://codecov.io/gh/co-analysis/a11ytables?branch=main"><img src="https://codecov.io/gh/co-analysis/a11ytables/branch/main/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Matt Dray.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
